(function(e,t){'object'==typeof exports&&'undefined'!=typeof module?module.exports=t():'function'==typeof define&&define.amd?define(t):e.rough=t()})(this,function(){'use strict';function e(e,t){return e.type===t}function t(e,t){var l=t.fillStyle||'hachure';if(!T[l])switch(l){case'zigzag':T[l]||(T[l]=new S(e));break;case'cross-hatch':T[l]||(T[l]=new A(e));break;case'hachure':default:l='hachure',T[l]||(T[l]=new O(e));}return T[l]}function l(e){if(z&&E&&self&&self.workly&&e.async&&!e.noWorker){var t=e.worklyURL||'https://cdn.jsdelivr.net/gh/pshihn/workly/dist/workly.min.js';if(t){var l=URL.createObjectURL(new Blob(['importScripts(\''+t+'\', \''+E+'\');\nworkly.expose(self.rough.createRenderer());']));return self.workly.proxy(l)}}return new C}var a=Math.round,n=Math.max,s=Math.min,i=Math.pow,r=Math.floor,p=Math.sqrt,d=Math.cos,h=Math.sin,g=Math.abs,f=Math.PI,o='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},u=function(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')},y=function(){function e(e,t){for(var l,a=0;a<t.length;a++)l=t[a],l.enumerable=l.enumerable||!1,l.configurable=!0,'value'in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}return function(t,l,a){return l&&e(t.prototype,l),a&&e(t,a),t}}(),c=function(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},v=function(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e},_={A:{length:7},a:{length:7},C:{length:6},c:{length:6},H:{length:1},h:{length:1},L:{length:2},l:{length:2},M:{length:2},m:{length:2},Q:{length:4},q:{length:4},S:{length:4},s:{length:4},T:{length:4},t:{length:2},V:{length:1},v:{length:1},Z:{length:0},z:{length:0}},k=function(){function t(e){u(this,t),this.COMMAND=0,this.NUMBER=1,this.EOD=2,this.segments=[],this.parseData(e),this.processPoints()}return y(t,[{key:'tokenize',value:function(e){for(var t=[];''!==e;)if(e.match(/^([ \t\r\n,]+)/))e=e.substr(RegExp.$1.length);else if(e.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]={type:this.COMMAND,text:RegExp.$1},e=e.substr(RegExp.$1.length);else if(e.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))t[t.length]={type:this.NUMBER,text:''+parseFloat(RegExp.$1)},e=e.substr(RegExp.$1.length);else return console.error('Unrecognized segment command: '+e),[];return t[t.length]={type:this.EOD,text:''},t}},{key:'parseData',value:function(t){var l=this.tokenize(t),a=0,n=l[a],s='BOD';for(this.segments=[];!e(n,this.EOD);){var o=void 0,r=[];if('BOD'!==s)e(n,this.NUMBER)?o=_[s].length:(a++,o=_[n.text].length,s=n.text);else if('M'===n.text||'m'===n.text)a++,o=_[n.text].length,s=n.text;else return void this.parseData('M0,0'+t);if(a+o<l.length){for(var p,d=a;d<a+o;d++)if(p=l[d],e(p,this.NUMBER))r[r.length]=+p.text;else return void console.error('Parameter type is not a number: '+s+','+p.text);if(_[s]){var h={key:s,data:r};this.segments.push(h),a+=o,n=l[a],'M'===s&&(s='L'),'m'===s&&(s='l')}else return void console.error('Unsupported segment type: '+s)}else console.error('Path data ended before all parameters were found')}}},{key:'processPoints',value:function(){for(var e,t=null,l=[0,0],a=0;a<this.segments.length;a++){switch(e=this.segments[a],e.key){case'M':case'L':case'T':e.point=[e.data[0],e.data[1]];break;case'm':case'l':case't':e.point=[e.data[0]+l[0],e.data[1]+l[1]];break;case'H':e.point=[e.data[0],l[1]];break;case'h':e.point=[e.data[0]+l[0],l[1]];break;case'V':e.point=[l[0],e.data[0]];break;case'v':e.point=[l[0],e.data[0]+l[1]];break;case'z':case'Z':t&&(e.point=[t[0],t[1]]);break;case'C':e.point=[e.data[4],e.data[5]];break;case'c':e.point=[e.data[4]+l[0],e.data[5]+l[1]];break;case'S':e.point=[e.data[2],e.data[3]];break;case's':e.point=[e.data[2]+l[0],e.data[3]+l[1]];break;case'Q':e.point=[e.data[2],e.data[3]];break;case'q':e.point=[e.data[2]+l[0],e.data[3]+l[1]];break;case'A':e.point=[e.data[5],e.data[6]];break;case'a':e.point=[e.data[5]+l[0],e.data[6]+l[1]];}('m'===e.key||'M'===e.key)&&(t=null),e.point&&(l=e.point,!t&&(t=e.point)),('z'===e.key||'Z'===e.key)&&(t=null)}}},{key:'closed',get:function(){if('undefined'==typeof this._closed){this._closed=!1;var e=!0,t=!1,l=void 0;try{for(var a,n,i=this.segments[Symbol.iterator]();!(e=(a=i.next()).done);e=!0)n=a.value,'z'===n.key.toLowerCase()&&(this._closed=!0)}catch(e){t=!0,l=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw l}}}return this._closed}}]),t}(),x=function(){function e(t){u(this,e),this._position=[0,0],this._first=null,this.bezierReflectionPoint=null,this.quadReflectionPoint=null,this.parsed=new k(t)}return y(e,[{key:'setPosition',value:function(e,t){this._position=[e,t],this._first||(this._first=[e,t])}},{key:'segments',get:function(){return this.parsed.segments}},{key:'closed',get:function(){return this.parsed.closed}},{key:'linearPoints',get:function(){if(!this._linearPoints){var e=[],t=[],l=!0,a=!1,n=void 0;try{for(var i,o=this.parsed.segments[Symbol.iterator]();!(l=(i=o.next()).done);l=!0){var r=i.value,s=r.key.toLowerCase();('m'===s||'z'===s)&&(t.length&&(e.push(t),t=[]),'z'===s)||r.point&&t.push(r.point)}}catch(e){a=!0,n=e}finally{try{!l&&o.return&&o.return()}finally{if(a)throw n}}t.length&&(e.push(t),t=[]),this._linearPoints=e}return this._linearPoints}},{key:'first',get:function(){return this._first},set:function(e){this._first=e}},{key:'position',get:function(){return this._position}},{key:'x',get:function(){return this._position[0]}},{key:'y',get:function(){return this._position[1]}}]),e}(),b=function(){function e(t,l,a,n,i,o){if(u(this,e),this._segIndex=0,this._numSegs=0,this._rx=0,this._ry=0,this._sinPhi=0,this._cosPhi=0,this._C=[0,0],this._theta=0,this._delta=0,this._T=0,this._from=t,t[0]!==l[0]||t[1]!==l[1]){var r=f/180;this._rx=g(a[0]),this._ry=g(a[1]),this._sinPhi=h(n*r),this._cosPhi=d(n*r);var y=this._cosPhi*(t[0]-l[0])/2+this._sinPhi*(t[1]-l[1])/2,c=-this._sinPhi*(t[0]-l[0])/2+this._cosPhi*(t[1]-l[1])/2,v=0,_=this._rx*this._rx*this._ry*this._ry-this._rx*this._rx*c*c-this._ry*this._ry*y*y;if(0>_){var k=p(1-_/(this._rx*this._rx*this._ry*this._ry));this._rx*=k,this._ry*=k,v=0}else v=(i===o?-1:1)*p(_/(this._rx*this._rx*c*c+this._ry*this._ry*y*y));var s=v*this._rx*c/this._ry,x=-v*this._ry*y/this._rx;this._C=[0,0],this._C[0]=this._cosPhi*s-this._sinPhi*x+(t[0]+l[0])/2,this._C[1]=this._sinPhi*s+this._cosPhi*x+(t[1]+l[1])/2,this._theta=this.calculateVectorAngle(1,0,(y-s)/this._rx,(c-x)/this._ry);var b=this.calculateVectorAngle((y-s)/this._rx,(c-x)/this._ry,(-y-s)/this._rx,(-c-x)/this._ry);!o&&0<b?b-=2*f:o&&0>b&&(b+=2*f),this._numSegs=Math.ceil(g(b/(f/2))),this._delta=b/this._numSegs,this._T=8/3*h(this._delta/4)*h(this._delta/4)/h(this._delta/2)}}return y(e,[{key:'getNextSegment',value:function(){if(this._segIndex===this._numSegs)return null;var e=d(this._theta),t=h(this._theta),l=this._theta+this._delta,a=d(l),n=h(l),i=[this._cosPhi*this._rx*a-this._sinPhi*this._ry*n+this._C[0],this._sinPhi*this._rx*a+this._cosPhi*this._ry*n+this._C[1]],s=[this._from[0]+this._T*(-this._cosPhi*this._rx*t-this._sinPhi*this._ry*e),this._from[1]+this._T*(-this._sinPhi*this._rx*t+this._cosPhi*this._ry*e)],o=[i[0]+this._T*(this._cosPhi*this._rx*n+this._sinPhi*this._ry*a),i[1]+this._T*(this._sinPhi*this._rx*n-this._cosPhi*this._ry*a)];return this._theta=l,this._from=[i[0],i[1]],this._segIndex++,{cp1:s,cp2:o,to:i}}},{key:'calculateVectorAngle',value:function(e,t,l,a){var n=Math.atan2,i=n(t,e),s=n(a,l);return s>=i?s-i:2*f-(i-s)}}]),e}(),m=function(){function e(t,l){u(this,e),this.sets=t,this.closed=l}return y(e,[{key:'fit',value:function(e){var t=[],l=!0,a=!1,n=void 0;try{for(var s,o=this.sets[Symbol.iterator]();!(l=(s=o.next()).done);l=!0){var p=s.value,h=p.length,g=r(e*h);if(5>g){if(5>=h)continue;g=5}t.push(this.reduce(p,g))}}catch(e){a=!0,n=e}finally{try{!l&&o.return&&o.return()}finally{if(a)throw n}}var f='',u=!0,y=!1,c=void 0;try{for(var v,_,k=t[Symbol.iterator]();!(u=(v=k.next()).done);u=!0){_=v.value;for(var x,b=0;b<_.length;b++)x=_[b],f+=0===b?'M'+x[0]+','+x[1]:'L'+x[0]+','+x[1];this.closed&&(f+='z ')}}catch(e){y=!0,c=e}finally{try{!u&&k.return&&k.return()}finally{if(y)throw c}}return f}},{key:'distance',value:function(e,t){return p(i(e[0]-t[0],2)+i(e[1]-t[1],2))}},{key:'reduce',value:function(e,t){if(e.length<=t)return e;for(var l=e.slice(0);l.length>t;){for(var n=-1,o=-1,r=1;r<l.length-1;r++){var d=this.distance(l[r-1],l[r]),a=this.distance(l[r],l[r+1]),h=this.distance(l[r-1],l[r+1]),g=(d+a+h)/2,s=p(g*(g-d)*(g-a)*(g-h));(0>n||s<n)&&(n=s,o=r)}if(0<o)l.splice(o,1);else break}return l}}]),e}(),w=function(){function e(l,a){u(this,e),this.xi=t,this.yi=t,this.px1=l[0],this.py1=l[1],this.px2=a[0],this.py2=a[1],this.a=this.py2-this.py1,this.b=this.px1-this.px2,this.c=this.px2*this.py1-this.px1*this.py2,this._undefined=0===this.a&&0===this.b&&0===this.c}var t=Number.MAX_VALUE;return y(e,[{key:'isUndefined',value:function(){return this._undefined}},{key:'intersects',value:function(e){if(this.isUndefined()||e.isUndefined())return!1;var l=t,i=t,o=0,r=0,p=this.a,a=this.b,d=this.c;return(1e-5<g(a)&&(l=-p/a,o=-d/a),1e-5<g(e.b)&&(i=-e.a/e.b,r=-e.c/e.b),l===t)?i===t?-d/p==-e.c/e.a&&(this.py1>=s(e.py1,e.py2)&&this.py1<=n(e.py1,e.py2)?(this.xi=this.px1,this.yi=this.py1,!0):!!(this.py2>=s(e.py1,e.py2)&&this.py2<=n(e.py1,e.py2))&&(this.xi=this.px2,this.yi=this.py2,!0)):(this.xi=this.px1,this.yi=i*this.xi+r,!(-1e-5>(this.py1-this.yi)*(this.yi-this.py2)||-1e-5>(e.py1-this.yi)*(this.yi-e.py2))&&(!(1e-5>g(e.a))||!(-1e-5>(e.px1-this.xi)*(this.xi-e.px2)))):i===t?(this.xi=e.px1,this.yi=l*this.xi+o,!(-1e-5>(e.py1-this.yi)*(this.yi-e.py2)||-1e-5>(this.py1-this.yi)*(this.yi-this.py2))&&(!(1e-5>g(p))||!(-1e-5>(this.px1-this.xi)*(this.xi-this.px2)))):l===i?o==r&&(this.px1>=s(e.px1,e.px2)&&this.px1<=n(e.py1,e.py2)?(this.xi=this.px1,this.yi=this.py1,!0):!!(this.px2>=s(e.px1,e.px2)&&this.px2<=n(e.px1,e.px2))&&(this.xi=this.px2,this.yi=this.py2,!0)):(this.xi=(r-o)/(l-i),this.yi=l*this.xi+o,!(-1e-5>(this.px1-this.xi)*(this.xi-this.px2)||-1e-5>(e.px1-this.xi)*(this.xi-e.px2)))}}]),e}(),P=function(){function e(t,l,a,n,i,s,o,r){u(this,e),this.deltaX=0,this.hGap=0,this.top=t,this.bottom=l,this.left=a,this.right=n,this.gap=i,this.sinAngle=s,this.tanAngle=r,1e-4>g(s)?this.pos=a+i:.9999<g(s)?this.pos=t+i:(this.deltaX=(l-t)*g(r),this.pos=a-g(this.deltaX),this.hGap=g(i/o),this.sLeft=new w([a,l],[a,t]),this.sRight=new w([n,l],[n,t]))}return y(e,[{key:'nextLine',value:function(){if(1e-4>g(this.sinAngle)){if(this.pos<this.right){var e=[this.pos,this.top,this.pos,this.bottom];return this.pos+=this.gap,e}}else if(!(.9999<g(this.sinAngle))){var t=this.pos-this.deltaX/2,l=this.pos+this.deltaX/2,a=this.bottom,n=this.top;if(this.pos<this.right+this.deltaX){for(;t<this.left&&l<this.left||t>this.right&&l>this.right;)if(this.pos+=this.hGap,t=this.pos-this.deltaX/2,l=this.pos+this.deltaX/2,this.pos>this.right+this.deltaX)return null;var i=new w([t,a],[l,n]);this.sLeft&&i.intersects(this.sLeft)&&(t=i.xi,a=i.yi),this.sRight&&i.intersects(this.sRight)&&(l=i.xi,n=i.yi),0<this.tanAngle&&(t=this.right-(t-this.left),l=this.right-(l-this.left));var s=[t,a,l,n];return this.pos+=this.hGap,s}}else if(this.pos<this.bottom){var o=[this.left,this.pos,this.right,this.pos];return this.pos+=this.gap,o}return null}}]),e}(),O=function(){function e(t){u(this,e),this.renderer=t}var t=Math.tan;return y(e,[{key:'fillPolygon',value:function(e,t){return this._fillPolygon(e,t)}},{key:'fillEllipse',value:function(e,t,l,a,n){return this._fillEllipse(e,t,l,a,n)}},{key:'_fillPolygon',value:function(e,l){var a=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],o=[];if(e&&e.length){for(var r=e[0][0],p=e[0][0],g=e[0][1],u=e[0][1],y=1;y<e.length;y++)r=s(r,e[y][0]),p=n(p,e[y][0]),g=s(g,e[y][1]),u=n(u,e[y][1]);var c=l.hachureAngle,v=l.hachureGap;0>v&&(v=4*l.strokeWidth),v=n(v,.1);for(var _=c%180*(f/180),k=d(_),x=h(_),b=t(_),m=new P(g-1,u+1,r-1,p+1,v,x,k,b),w=void 0,O=null;null!=(w=m.nextLine());)for(var S=this.getIntersectingLines(w,e),A=0;A<S.length;A++)if(A<S.length-1){var T=S[A],C=S[A+1];o=o.concat(this.renderer.doubleLine(T[0],T[1],C[0],C[1],l)),a&&O&&(o=o.concat(this.renderer.doubleLine(O[0],O[1],T[0],T[1],l))),O=C}}return{type:'fillSketch',ops:o}}},{key:'_fillEllipse',value:function(e,l,a,n,i){var s=!!(5<arguments.length&&void 0!==arguments[5])&&arguments[5],o=[],r=g(a/2),d=g(n/2);r+=this.renderer.getOffset(.05*-r,.05*r,i),d+=this.renderer.getOffset(.05*-d,.05*d,i);var h=i.hachureAngle,u=i.hachureGap;0>=u&&(u=4*i.strokeWidth);var y=i.fillWeight;0>y&&(y=i.strokeWidth/2);for(var c=t(h%180*(f/180)),v=d/r,_=p(v*c*v*c+1),k=v*c/_,x=1/_,b=u/(r*d/p(d*x*(d*x)+r*k*(r*k))/r),m=p(r*r-(e-r+b)*(e-r+b)),w=null,P=e-r+b;P<e+r;P+=b){m=p(r*r-(e-P)*(e-P));var O=this.affine(P,l-m,e,l,k,x,v),S=this.affine(P,l+m,e,l,k,x,v);o=o.concat(this.renderer.doubleLine(O[0],O[1],S[0],S[1],i)),s&&w&&(o=o.concat(this.renderer.doubleLine(w[0],w[1],O[0],O[1],i))),w=S}return{type:'fillSketch',ops:o}}},{key:'getIntersectingLines',value:function(e,t){for(var l,a=[],n=new w([e[0],e[1]],[e[2],e[3]]),s=0;s<t.length;s++)l=new w(t[s],t[(s+1)%t.length]),n.intersects(l)&&a.push([n.xi,n.yi]);return a}},{key:'affine',value:function(e,t,l,a,n,i,s){return[-l*i-a*n+l+i*e+n*t,s*(l*n-a*i)+a+-s*n*e+s*i*t]}}]),e}(),S=function(e){function t(){return u(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,e),y(t,[{key:'fillPolygon',value:function(e,t){return this._fillPolygon(e,t,!0)}},{key:'fillEllipse',value:function(e,t,l,a,n){return this._fillEllipse(e,t,l,a,n,!0)}}]),t}(O),A=function(e){function t(){return u(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,e),y(t,[{key:'fillPolygon',value:function(e,t){var l=this._fillPolygon(e,t),a=Object.assign({},t,{hachureAngle:t.hachureAngle+90}),n=this._fillPolygon(e,a);return l.ops=l.ops.concat(n.ops),l}},{key:'fillEllipse',value:function(e,t,l,a,n){var i=this._fillEllipse(e,t,l,a,n),s=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),o=this._fillEllipse(e,t,l,a,s);return i.ops=i.ops.concat(o.ops),i}}]),t}(O),T={},C=function(){function e(){u(this,e)}return y(e,[{key:'line',value:function(e,t,l,a,n){var i=this.doubleLine(e,t,l,a,n);return{type:'path',ops:i}}},{key:'linearPath',value:function(e,t,l){var a=(e||[]).length;if(2<a){for(var n=[],s=0;s<a-1;s++)n=n.concat(this.doubleLine(e[s][0],e[s][1],e[s+1][0],e[s+1][1],l));return t&&(n=n.concat(this.doubleLine(e[a-1][0],e[a-1][1],e[0][0],e[0][1],l))),{type:'path',ops:n}}return 2===a?this.line(e[0][0],e[0][1],e[1][0],e[1][1],l):{type:'path',ops:[]}}},{key:'polygon',value:function(e,t){return this.linearPath(e,!0,t)}},{key:'rectangle',value:function(e,t,l,a,n){return this.polygon([[e,t],[e+l,t],[e+l,t+a],[e,t+a]],n)}},{key:'curve',value:function(e,t){var l=this._curveWithOffset(e,1*(1+.2*t.roughness),t),a=this._curveWithOffset(e,1.5*(1+.22*t.roughness),t);return{type:'path',ops:l.concat(a)}}},{key:'ellipse',value:function(e,t,l,a,n){var i=2*f/n.curveStepCount,s=g(l/2),o=g(a/2);s+=this.getOffset(.05*-s,.05*s,n),o+=this.getOffset(.05*-o,.05*o,n);var r=this._ellipse(i,e,t,s,o,1,i*this.getOffset(.1,this.getOffset(.4,1,n),n),n),p=this._ellipse(i,e,t,s,o,1.5,0,n);return{type:'path',ops:r.concat(p)}}},{key:'arc',value:function(e,t,l,a,n,i,r,p,u){var o=e,y=t,c=g(l/2),v=g(a/2);c+=this.getOffset(.01*-c,.01*c,u),v+=this.getOffset(.01*-v,.01*v,u);for(var _=n,k=i;0>_;)_+=2*f,k+=2*f;k-_>2*f&&(_=0,k=2*f);var x=2*f/u.curveStepCount,b=s(x/2,(k-_)/2),m=this._arc(b,o,y,c,v,_,k,1,u),w=this._arc(b,o,y,c,v,_,k,1.5,u),P=m.concat(w);return r&&(p?(P=P.concat(this.doubleLine(o,y,o+c*d(_),y+v*h(_),u)),P=P.concat(this.doubleLine(o,y,o+c*d(k),y+v*h(k),u))):(P.push({op:'lineTo',data:[o,y]}),P.push({op:'lineTo',data:[o+c*d(_),y+v*h(_)]}))),{type:'path',ops:P}}},{key:'svgPath',value:function(e,t){e=(e||'').replace(/\n/g,' ').replace(/(-\s)/g,'-').replace('/(ss)/g',' ');var l=new x(e);if(t.simplification){var a=new m(l.linearPoints,l.closed),n=a.fit(t.simplification);l=new x(n)}for(var o=[],r=l.segments||[],d=0;d<r.length;d++){var h=r[d],s=0<d?r[d-1]:null,g=this._processSegment(l,h,s,t);g&&g.length&&(o=o.concat(g))}return{type:'path',ops:o}}},{key:'solidFillPolygon',value:function(e,t){var l=[];if(PointerEvent.length){var a=t.maxRandomnessOffset||0,n=e.length;if(2<n){l.push({op:'move',data:[e[0][0]+this.getOffset(-a,a,t),e[0][1]+this.getOffset(-a,a,t)]});for(var s=1;s<n;s++)l.push({op:'lineTo',data:[e[s][0]+this.getOffset(-a,a,t),e[s][1]+this.getOffset(-a,a,t)]})}}return{type:'fillPath',ops:l}}},{key:'patternFillPolygon',value:function(e,l){var a=t(this,l);return a.fillPolygon(e,l)}},{key:'patternFillEllipse',value:function(e,l,a,n,i){var s=t(this,i);return s.fillEllipse(e,l,a,n,i)}},{key:'patternFillArc',value:function(e,t,l,a,n,i,s){var o=e,r=t,p=g(l/2),u=g(a/2);p+=this.getOffset(.01*-p,.01*p,s),u+=this.getOffset(.01*-u,.01*u,s);for(var y=n,c=i;0>y;)y+=2*f,c+=2*f;c-y>2*f&&(y=0,c=2*f);for(var v=(c-y)/s.curveStepCount,_=[],k=y;k<=c;k+=v)_.push([o+p*d(k),r+u*h(k)]);return _.push([o+p*d(c),r+u*h(c)]),_.push([o,r]),this.patternFillPolygon(_,s)}},{key:'getOffset',value:function(e,t,l){return l.roughness*(Math.random()*(t-e)+e)}},{key:'doubleLine',value:function(e,t,l,a,n){var i=this._line(e,t,l,a,n,!0,!1),s=this._line(e,t,l,a,n,!0,!0);return i.concat(s)}},{key:'_line',value:function(e,t,l,a,n,s,o){var r=i(e-l,2)+i(t-a,2),d=n.maxRandomnessOffset||0;100*(d*d)>r&&(d=p(r)/10);var h=d/2,g=.2+.2*Math.random(),f=n.bowing*n.maxRandomnessOffset*(a-t)/200,u=n.bowing*n.maxRandomnessOffset*(e-l)/200;f=this.getOffset(-f,f,n),u=this.getOffset(-u,u,n);var y=[];return s&&(o?y.push({op:'move',data:[e+this.getOffset(-h,h,n),t+this.getOffset(-h,h,n)]}):y.push({op:'move',data:[e+this.getOffset(-d,d,n),t+this.getOffset(-d,d,n)]})),o?y.push({op:'bcurveTo',data:[f+e+(l-e)*g+this.getOffset(-h,h,n),u+t+(a-t)*g+this.getOffset(-h,h,n),f+e+2*(l-e)*g+this.getOffset(-h,h,n),u+t+2*(a-t)*g+this.getOffset(-h,h,n),l+this.getOffset(-h,h,n),a+this.getOffset(-h,h,n)]}):y.push({op:'bcurveTo',data:[f+e+(l-e)*g+this.getOffset(-d,d,n),u+t+(a-t)*g+this.getOffset(-d,d,n),f+e+2*(l-e)*g+this.getOffset(-d,d,n),u+t+2*(a-t)*g+this.getOffset(-d,d,n),l+this.getOffset(-d,d,n),a+this.getOffset(-d,d,n)]}),y}},{key:'_curve',value:function(e,t,l){var a=e.length,n=[];if(3<a){var o=[],r=1-l.curveTightness;n.push({op:'move',data:[e[1][0],e[1][1]]});for(var s,p=1;p+2<a;p++)s=e[p],o[0]=[s[0],s[1]],o[1]=[s[0]+(r*e[p+1][0]-r*e[p-1][0])/6,s[1]+(r*e[p+1][1]-r*e[p-1][1])/6],o[2]=[e[p+1][0]+(r*e[p][0]-r*e[p+2][0])/6,e[p+1][1]+(r*e[p][1]-r*e[p+2][1])/6],o[3]=[e[p+1][0],e[p+1][1]],n.push({op:'bcurveTo',data:[o[1][0],o[1][1],o[2][0],o[2][1],o[3][0],o[3][1]]});if(t&&2===t.length){var d=l.maxRandomnessOffset;n.push({op:'lineTo',data:[t[0]+this.getOffset(-d,d,l),t[1]+ +this.getOffset(-d,d,l)]})}}else 3===a?(n.push({op:'move',data:[e[1][0],e[1][1]]}),n.push({op:'bcurveTo',data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):2===a&&(n=n.concat(this.doubleLine(e[0][0],e[0][1],e[1][0],e[1][1],l)));return n}},{key:'_ellipse',value:function(e,t,l,a,n,i,s,r){var o=this.getOffset(-.5,.5,r)-f/2,p=[];p.push([this.getOffset(-i,i,r)+t+.9*a*d(o-e),this.getOffset(-i,i,r)+l+.9*n*h(o-e)]);for(var g=o;g<2*f+o-.01;g+=e)p.push([this.getOffset(-i,i,r)+t+a*d(g),this.getOffset(-i,i,r)+l+n*h(g)]);return p.push([this.getOffset(-i,i,r)+t+a*d(o+2*f+.5*s),this.getOffset(-i,i,r)+l+n*h(o+2*f+.5*s)]),p.push([this.getOffset(-i,i,r)+t+.98*a*d(o+s),this.getOffset(-i,i,r)+l+.98*n*h(o+s)]),p.push([this.getOffset(-i,i,r)+t+.9*a*d(o+.5*s),this.getOffset(-i,i,r)+l+.9*n*h(o+.5*s)]),this._curve(p,null,r)}},{key:'_curveWithOffset',value:function(e,t,l){for(var a=[[e[0][0]+this.getOffset(-t,t,l),e[0][1]+this.getOffset(-t,t,l)],[e[0][0]+this.getOffset(-t,t,l),e[0][1]+this.getOffset(-t,t,l)]],n=1;n<e.length;n++)a.push([e[n][0]+this.getOffset(-t,t,l),e[n][1]+this.getOffset(-t,t,l)]),n===e.length-1&&a.push([e[n][0]+this.getOffset(-t,t,l),e[n][1]+this.getOffset(-t,t,l)]);return this._curve(a,null,l)}},{key:'_arc',value:function(e,t,l,a,n,i,s,r,p){var o=i+this.getOffset(-.1,.1,p),g=[];g.push([this.getOffset(-r,r,p)+t+.9*a*d(o-e),this.getOffset(-r,r,p)+l+.9*n*h(o-e)]);for(var f=o;f<=s;f+=e)g.push([this.getOffset(-r,r,p)+t+a*d(f),this.getOffset(-r,r,p)+l+n*h(f)]);return g.push([t+a*d(s),l+n*h(s)]),g.push([t+a*d(s),l+n*h(s)]),this._curve(g,null,p)}},{key:'_bezierTo',value:function(e,t,l,a,n,s,r,p){for(var o=[],d=[p.maxRandomnessOffset||1,(p.maxRandomnessOffset||1)+.5],h=[0,0],g=0;2>g;g++)0===g?o.push({op:'move',data:[r.x,r.y]}):o.push({op:'move',data:[r.x+this.getOffset(-d[0],d[0],p),r.y+this.getOffset(-d[0],d[0],p)]}),h=[n+this.getOffset(-d[g],d[g],p),s+this.getOffset(-d[g],d[g],p)],o.push({op:'bcurveTo',data:[e+this.getOffset(-d[g],d[g],p),t+this.getOffset(-d[g],d[g],p),l+this.getOffset(-d[g],d[g],p),a+this.getOffset(-d[g],d[g],p),h[0],h[1]]});return r.setPosition(h[0],h[1]),o}},{key:'_processSegment',value:function(e,t,l,a){var n=[];switch(t.key){case'M':case'm':{var s='m'===t.key;if(2<=t.data.length){var o=+t.data[0],r=+t.data[1];s&&(o+=e.x,r+=e.y);var p=1*(a.maxRandomnessOffset||0);o+=this.getOffset(-p,p,a),r+=this.getOffset(-p,p,a),e.setPosition(o,r),n.push({op:'move',data:[o,r]})}break}case'L':case'l':{var d='l'===t.key;if(2<=t.data.length){var h=+t.data[0],g=+t.data[1];d&&(h+=e.x,g+=e.y),n=n.concat(this.doubleLine(e.x,e.y,h,g,a)),e.setPosition(h,g)}break}case'H':case'h':{var u='h'===t.key;if(t.data.length){var c=+t.data[0];u&&(c+=e.x),n=n.concat(this.doubleLine(e.x,e.y,c,e.y,a)),e.setPosition(c,e.y)}break}case'V':case'v':{var v='v'===t.key;if(t.data.length){var _=+t.data[0];v&&(_+=e.y),n=n.concat(this.doubleLine(e.x,e.y,e.x,_,a)),e.setPosition(e.x,_)}break}case'Z':case'z':{e.first&&(n=n.concat(this.doubleLine(e.x,e.y,e.first[0],e.first[1],a)),e.setPosition(e.first[0],e.first[1]),e.first=null);break}case'C':case'c':{var k='c'===t.key;if(6<=t.data.length){var m=+t.data[0],w=+t.data[1],P=+t.data[2],O=+t.data[3],S=+t.data[4],A=+t.data[5];k&&(m+=e.x,P+=e.x,S+=e.x,w+=e.y,O+=e.y,A+=e.y);var T=this._bezierTo(m,w,P,O,S,A,e,a);n=n.concat(T),e.bezierReflectionPoint=[S+(S-P),A+(A-O)]}break}case'S':case's':{var C='s'===t.key;if(4<=t.data.length){var z=+t.data[0],E=+t.data[1],L=+t.data[2],R=+t.data[3];C&&(z+=e.x,L+=e.x,E+=e.y,R+=e.y);var W=z,N=E,D=l?l.key:'',B=null;('c'===D||'C'===D||'s'===D||'S'===D)&&(B=e.bezierReflectionPoint),B&&(W=B[0],N=B[1]);var F=this._bezierTo(W,N,z,E,L,R,e,a);n=n.concat(F),e.bezierReflectionPoint=[L+(L-z),R+(R-E)]}break}case'Q':case'q':{var M='q'===t.key;if(4<=t.data.length){var q=+t.data[0],U=+t.data[1],X=+t.data[2],V=+t.data[3];M&&(q+=e.x,X+=e.x,U+=e.y,V+=e.y);var G=1*(1+.2*a.roughness),j=1.5*(1+.22*a.roughness);n.push({op:'move',data:[e.x+this.getOffset(-G,G,a),e.y+this.getOffset(-G,G,a)]});var I=[X+this.getOffset(-G,G,a),V+this.getOffset(-G,G,a)];n.push({op:'qcurveTo',data:[q+this.getOffset(-G,G,a),U+this.getOffset(-G,G,a),I[0],I[1]]}),n.push({op:'move',data:[e.x+this.getOffset(-j,j,a),e.y+this.getOffset(-j,j,a)]}),I=[X+this.getOffset(-j,j,a),V+this.getOffset(-j,j,a)],n.push({op:'qcurveTo',data:[q+this.getOffset(-j,j,a),U+this.getOffset(-j,j,a),I[0],I[1]]}),e.setPosition(I[0],I[1]),e.quadReflectionPoint=[X+(X-q),V+(V-U)]}break}case'T':case't':{var Q='t'===t.key;if(2<=t.data.length){var $=+t.data[0],Z=+t.data[1];Q&&($+=e.x,Z+=e.y);var H=$,J=Z,Y=l?l.key:'',K=null;('q'===Y||'Q'===Y||'t'===Y||'T'===Y)&&(K=e.quadReflectionPoint),K&&(H=K[0],J=K[1]);var ee=1*(1+.2*a.roughness),te=1.5*(1+.22*a.roughness);n.push({op:'move',data:[e.x+this.getOffset(-ee,ee,a),e.y+this.getOffset(-ee,ee,a)]});var le=[$+this.getOffset(-ee,ee,a),Z+this.getOffset(-ee,ee,a)];n.push({op:'qcurveTo',data:[H+this.getOffset(-ee,ee,a),J+this.getOffset(-ee,ee,a),le[0],le[1]]}),n.push({op:'move',data:[e.x+this.getOffset(-te,te,a),e.y+this.getOffset(-te,te,a)]}),le=[$+this.getOffset(-te,te,a),Z+this.getOffset(-te,te,a)],n.push({op:'qcurveTo',data:[H+this.getOffset(-te,te,a),J+this.getOffset(-te,te,a),le[0],le[1]]}),e.setPosition(le[0],le[1]),e.quadReflectionPoint=[$+($-H),Z+(Z-J)]}break}case'A':case'a':{var ae='a'===t.key;if(7<=t.data.length){var ne=+t.data[0],ie=+t.data[1],se=+t.data[2],oe=+t.data[3],re=+t.data[4],pe=+t.data[5],de=+t.data[6];if(ae&&(pe+=e.x,de+=e.y),pe===e.x&&de===e.y)break;if(0==ne||0==ie)n=n.concat(this.doubleLine(e.x,e.y,pe,de,a)),e.setPosition(pe,de);else for(var he=0;1>he;he++)for(var ge,fe=new b([e.x,e.y],[pe,de],[ne,ie],se,!!oe,!!re),ue=fe.getNextSegment();ue;)ge=this._bezierTo(ue.cp1[0],ue.cp1[1],ue.cp2[0],ue.cp2[1],ue.to[0],ue.to[1],e,a),n=n.concat(ge),ue=fe.getNextSegment()}break}default:}return n}}]),e}(),z='undefined'!=typeof self,E=z&&self&&self.document&&self.document.currentScript&&self.document.currentScript.src,L='undefined'!=typeof self,R=function(){function e(t,a){u(this,e),this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:'#000',strokeWidth:1,curveTightness:0,curveStepCount:9,fill:null,fillStyle:'hachure',fillWeight:-1,hachureAngle:-41,hachureGap:-1},this.config=t||{},this.surface=a,this.renderer=l(this.config),this.config.options&&(this.defaultOptions=this._options(this.config.options))}return y(e,[{key:'_options',value:function(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}},{key:'_drawable',value:function(e,t,l){return{shape:e,sets:t||[],options:l||this.defaultOptions}}},{key:'getCanvasSize',value:function(){var e=function(e){return e&&'object'===('undefined'==typeof e?'undefined':o(e))&&e.baseVal&&e.baseVal.value?e.baseVal.value:e||100};return this.surface?[e(this.surface.width),e(this.surface.height)]:[100,100]}},{key:'computePolygonSize',value:function(e){if(e.length){for(var t=e[0][0],l=e[0][0],a=e[0][1],o=e[0][1],r=1;r<e.length;r++)t=s(t,e[r][0]),l=n(l,e[r][0]),a=s(a,e[r][1]),o=n(o,e[r][1]);return[l-t,o-a]}return[0,0]}},{key:'polygonPath',value:function(e){var t='';if(e.length){t='M'+e[0][0]+','+e[0][1];for(var l=1;l<e.length;l++)t=t+' L'+e[l][0]+','+e[l][1]}return t}},{key:'computePathSize',value:function(e){var t=[0,0];if(L&&self.document)try{var l=self.document.createElementNS('http://www.w3.org/2000/svg','svg');l.setAttribute('width','0'),l.setAttribute('height','0');var a=self.document.createElementNS('http://www.w3.org/2000/svg','path');a.setAttribute('d',e),l.appendChild(a),self.document.body.appendChild(l);var n=a.getBBox();n&&(t[0]=n.width||0,t[1]=n.height||0),self.document.body.removeChild(l)}catch(e){}var i=this.getCanvasSize();return t[0]*t[1]||(t=i),t[0]=s(t[0],i[0]),t[1]=s(t[1],i[1]),t}},{key:'line',value:function(e,t,l,a,n){var i=this._options(n);return this._drawable('line',[this.lib.line(e,t,l,a,i)],i)}},{key:'rectangle',value:function(e,t,l,a,n){var i=this._options(n),s=[];if(i.fill){var o=[[e,t],[e+l,t],[e+l,t+a],[e,t+a]];'solid'===i.fillStyle?s.push(this.lib.solidFillPolygon(o,i)):s.push(this.lib.patternFillPolygon(o,i))}return s.push(this.lib.rectangle(e,t,l,a,i)),this._drawable('rectangle',s,i)}},{key:'ellipse',value:function(e,t,l,a,n){var i=this._options(n),s=[];if(i.fill)if('solid'===i.fillStyle){var o=this.lib.ellipse(e,t,l,a,i);o.type='fillPath',s.push(o)}else s.push(this.lib.patternFillEllipse(e,t,l,a,i));return s.push(this.lib.ellipse(e,t,l,a,i)),this._drawable('ellipse',s,i)}},{key:'circle',value:function(e,t,l,a){var n=this.ellipse(e,t,l,l,a);return n.shape='circle',n}},{key:'linearPath',value:function(e,t){var l=this._options(t);return this._drawable('linearPath',[this.lib.linearPath(e,!1,l)],l)}},{key:'arc',value:function(e,t,l,a,n,i){var s=!!(6<arguments.length&&void 0!==arguments[6])&&arguments[6],r=arguments[7],p=this._options(r),o=[];if(s&&p.fill)if('solid'===p.fillStyle){var d=this.lib.arc(e,t,l,a,n,i,!0,!1,p);d.type='fillPath',o.push(d)}else o.push(this.lib.patternFillArc(e,t,l,a,n,i,p));return o.push(this.lib.arc(e,t,l,a,n,i,s,!0,p)),this._drawable('arc',o,p)}},{key:'curve',value:function(e,t){var l=this._options(t);return this._drawable('curve',[this.lib.curve(e,l)],l)}},{key:'polygon',value:function(e,t){var l=this._options(t),a=[];if(l.fill)if('solid'===l.fillStyle)a.push(this.lib.solidFillPolygon(e,l));else{var n=this.computePolygonSize(e),i=[[0,0],[n[0],0],[n[0],n[1]],[0,n[1]]],s=this.lib.patternFillPolygon(i,l);s.type='path2Dpattern',s.size=n,s.path=this.polygonPath(e),a.push(s)}return a.push(this.lib.linearPath(e,!0,l)),this._drawable('polygon',a,l)}},{key:'path',value:function(e,t){var l=this._options(t),a=[];if(!e)return this._drawable('path',a,l);if(l.fill)if('solid'===l.fillStyle)a.push({type:'path2Dfill',path:e,ops:[]});else{var n=this.computePathSize(e),i=[[0,0],[n[0],0],[n[0],n[1]],[0,n[1]]],s=this.lib.patternFillPolygon(i,l);s.type='path2Dpattern',s.size=n,s.path=e,a.push(s)}return a.push(this.lib.svgPath(e,l)),this._drawable('path',a,l)}},{key:'toPaths',value:function(e){var t=e.sets||[],l=e.options||this.defaultOptions,n=[],i=!0,s=!1,o=void 0;try{for(var r,p=t[Symbol.iterator]();!(i=(r=p.next()).done);i=!0){var d=r.value,h=null;switch(d.type){case'path':h={d:this.opsToPath(d),stroke:l.stroke,strokeWidth:l.strokeWidth,fill:'none'};break;case'fillPath':h={d:this.opsToPath(d),stroke:'none',strokeWidth:0,fill:l.fill||'none'};break;case'fillSketch':h=this.fillSketch(d,l);break;case'path2Dfill':h={d:d.path||'',stroke:'none',strokeWidth:0,fill:l.fill||'none'};break;case'path2Dpattern':{var g=d.size,f={x:0,y:0,width:1,height:1,viewBox:'0 0 '+a(g[0])+' '+a(g[1]),patternUnits:'objectBoundingBox',path:this.fillSketch(d,l)};h={d:d.path,stroke:'none',strokeWidth:0,pattern:f};break}}h&&n.push(h)}}catch(e){s=!0,o=e}finally{try{!i&&p.return&&p.return()}finally{if(s)throw o}}return n}},{key:'fillSketch',value:function(e,t){var l=t.fillWeight;return 0>l&&(l=t.strokeWidth/2),{d:this.opsToPath(e),stroke:t.fill||'none',strokeWidth:l,fill:'none'}}},{key:'opsToPath',value:function(e){var t='',l=!0,a=!1,n=void 0;try{for(var i,s=e.ops[Symbol.iterator]();!(l=(i=s.next()).done);l=!0){var o=i.value,r=o.data;switch(o.op){case'move':t+='M'+r[0]+' '+r[1]+' ';break;case'bcurveTo':t+='C'+r[0]+' '+r[1]+', '+r[2]+' '+r[3]+', '+r[4]+' '+r[5]+' ';break;case'qcurveTo':t+='Q'+r[0]+' '+r[1]+', '+r[2]+' '+r[3]+' ';break;case'lineTo':t+='L'+r[0]+' '+r[1]+' ';}}}catch(e){a=!0,n=e}finally{try{!l&&s.return&&s.return()}finally{if(a)throw n}}return t.trim()}},{key:'lib',get:function(){return this.renderer}}]),e}(),W='undefined'!=typeof document,N=function(){function e(t,l){u(this,e),this.canvas=t,this.ctx=this.canvas.getContext('2d'),this.gen=new R(l||null,this.canvas)}return y(e,[{key:'line',value:function(e,t,l,a,n){var i=this.gen.line(e,t,l,a,n);return this.draw(i),i}},{key:'rectangle',value:function(e,t,l,a,n){var i=this.gen.rectangle(e,t,l,a,n);return this.draw(i),i}},{key:'ellipse',value:function(e,t,l,a,n){var i=this.gen.ellipse(e,t,l,a,n);return this.draw(i),i}},{key:'circle',value:function(e,t,l,a){var n=this.gen.circle(e,t,l,a);return this.draw(n),n}},{key:'linearPath',value:function(e,t){var l=this.gen.linearPath(e,t);return this.draw(l),l}},{key:'polygon',value:function(e,t){var l=this.gen.polygon(e,t);return this.draw(l),l}},{key:'arc',value:function(e,t,l,a,n,i){var s=!!(6<arguments.length&&void 0!==arguments[6])&&arguments[6],o=arguments[7],r=this.gen.arc(e,t,l,a,n,i,s,o);return this.draw(r),r}},{key:'curve',value:function(e,t){var l=this.gen.curve(e,t);return this.draw(l),l}},{key:'path',value:function(e,t){var l=this.gen.path(e,t);return this.draw(l),l}},{key:'draw',value:function(e){var t=e.sets||[],l=e.options||this.gen.defaultOptions,a=this.ctx,n=!0,i=!1,s=void 0;try{for(var o,r,p=t[Symbol.iterator]();!(n=(o=p.next()).done);n=!0)switch(r=o.value,r.type){case'path':a.save(),a.strokeStyle=l.stroke,a.lineWidth=l.strokeWidth,this._drawToContext(a,r),a.restore();break;case'fillPath':a.save(),a.fillStyle=l.fill||'',this._drawToContext(a,r),a.restore();break;case'fillSketch':this.fillSketch(a,r,l);break;case'path2Dfill':{this.ctx.save(),this.ctx.fillStyle=l.fill||'';var d=new Path2D(r.path);this.ctx.fill(d),this.ctx.restore();break}case'path2Dpattern':{if(W){var h=r.size,g=document.createElement('canvas'),f=g.getContext('2d'),u=this.computeBBox(r.path);u&&(u.width||u.height)?(g.width=this.canvas.width,g.height=this.canvas.height,f.translate(u.x||0,u.y||0)):(g.width=h[0],g.height=h[1]),this.fillSketch(f,r,l),this.ctx.save(),this.ctx.fillStyle=this.ctx.createPattern(g,'repeat');var y=new Path2D(r.path);this.ctx.fill(y),this.ctx.restore()}break}}}catch(e){i=!0,s=e}finally{try{!n&&p.return&&p.return()}finally{if(i)throw s}}}},{key:'computeBBox',value:function(e){if(W)try{var t=document.createElementNS('http://www.w3.org/2000/svg','svg');t.setAttribute('width','0'),t.setAttribute('height','0');var l=self.document.createElementNS('http://www.w3.org/2000/svg','path');l.setAttribute('d',e),t.appendChild(l),document.body.appendChild(t);var a=l.getBBox();return document.body.removeChild(t),a}catch(e){}return null}},{key:'fillSketch',value:function(e,t,l){var a=l.fillWeight;0>a&&(a=l.strokeWidth/2),e.save(),e.strokeStyle=l.fill||'',e.lineWidth=a,this._drawToContext(e,t),e.restore()}},{key:'_drawToContext',value:function(e,t){e.beginPath();var l=!0,a=!1,n=void 0;try{for(var i,s=t.ops[Symbol.iterator]();!(l=(i=s.next()).done);l=!0){var o=i.value,r=o.data;switch(o.op){case'move':e.moveTo(r[0],r[1]);break;case'bcurveTo':e.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);break;case'qcurveTo':e.quadraticCurveTo(r[0],r[1],r[2],r[3]);break;case'lineTo':e.lineTo(r[0],r[1]);}}}catch(e){a=!0,n=e}finally{try{!l&&s.return&&s.return()}finally{if(a)throw n}}'fillPath'===t.type?e.fill():e.stroke()}},{key:'generator',get:function(){return this.gen}}],[{key:'createRenderer',value:function(){return new C}}]),e}(),D=function(e){function t(){return u(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,e),y(t,[{key:'line',value:async function(e,t,l,a,n){var i=this._options(n);return this._drawable('line',[await this.lib.line(e,t,l,a,i)],i)}},{key:'rectangle',value:async function(e,t,l,a,n){var i=this._options(n),s=[];if(i.fill){var o=[[e,t],[e+l,t],[e+l,t+a],[e,t+a]];'solid'===i.fillStyle?s.push((await this.lib.solidFillPolygon(o,i))):s.push((await this.lib.patternFillPolygon(o,i)))}return s.push((await this.lib.rectangle(e,t,l,a,i))),this._drawable('rectangle',s,i)}},{key:'ellipse',value:async function(e,t,l,a,n){var i=this._options(n),s=[];if(i.fill)if('solid'===i.fillStyle){var o=await this.lib.ellipse(e,t,l,a,i);o.type='fillPath',s.push(o)}else s.push((await this.lib.patternFillEllipse(e,t,l,a,i)));return s.push((await this.lib.ellipse(e,t,l,a,i))),this._drawable('ellipse',s,i)}},{key:'circle',value:async function(e,t,l,a){var n=await this.ellipse(e,t,l,l,a);return n.shape='circle',n}},{key:'linearPath',value:async function(e,t){var l=this._options(t);return this._drawable('linearPath',[await this.lib.linearPath(e,!1,l)],l)}},{key:'arc',value:async function(e,t,l,a,n,i){var s=!!(6<arguments.length&&void 0!==arguments[6])&&arguments[6],r=arguments[7],p=this._options(r),o=[];if(s&&p.fill)if('solid'===p.fillStyle){var d=await this.lib.arc(e,t,l,a,n,i,!0,!1,p);d.type='fillPath',o.push(d)}else o.push((await this.lib.patternFillArc(e,t,l,a,n,i,p)));return o.push((await this.lib.arc(e,t,l,a,n,i,s,!0,p))),this._drawable('arc',o,p)}},{key:'curve',value:async function(e,t){var l=this._options(t);return this._drawable('curve',[await this.lib.curve(e,l)],l)}},{key:'polygon',value:async function(e,t){var l=this._options(t),a=[];if(l.fill)if('solid'===l.fillStyle)a.push((await this.lib.solidFillPolygon(e,l)));else{var n=this.computePolygonSize(e),i=[[0,0],[n[0],0],[n[0],n[1]],[0,n[1]]],s=await this.lib.patternFillPolygon(i,l);s.type='path2Dpattern',s.size=n,s.path=this.polygonPath(e),a.push(s)}return a.push((await this.lib.linearPath(e,!0,l))),this._drawable('polygon',a,l)}},{key:'path',value:async function(e,t){var l=this._options(t),a=[];if(!e)return this._drawable('path',a,l);if(l.fill)if('solid'===l.fillStyle)a.push({type:'path2Dfill',path:e,ops:[]});else{var n=this.computePathSize(e),i=[[0,0],[n[0],0],[n[0],n[1]],[0,n[1]]],s=await this.lib.patternFillPolygon(i,l);s.type='path2Dpattern',s.size=n,s.path=e,a.push(s)}return a.push((await this.lib.svgPath(e,l))),this._drawable('path',a,l)}}]),t}(R),B=function(e){function t(e,l){u(this,t);var a=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l));return a.genAsync=new D(l||null,a.canvas),a}return c(t,e),y(t,[{key:'line',value:async function(e,t,l,a,n){var i=await this.genAsync.line(e,t,l,a,n);return this.draw(i),i}},{key:'rectangle',value:async function(e,t,l,a,n){var i=await this.genAsync.rectangle(e,t,l,a,n);return this.draw(i),i}},{key:'ellipse',value:async function(e,t,l,a,n){var i=await this.genAsync.ellipse(e,t,l,a,n);return this.draw(i),i}},{key:'circle',value:async function(e,t,l,a){var n=await this.genAsync.circle(e,t,l,a);return this.draw(n),n}},{key:'linearPath',value:async function(e,t){var l=await this.genAsync.linearPath(e,t);return this.draw(l),l}},{key:'polygon',value:async function(e,t){var l=await this.genAsync.polygon(e,t);return this.draw(l),l}},{key:'arc',value:async function(e,t,l,a,n,i){var s=!!(6<arguments.length&&void 0!==arguments[6])&&arguments[6],o=arguments[7],r=await this.genAsync.arc(e,t,l,a,n,i,s,o);return this.draw(r),r}},{key:'curve',value:async function(e,t){var l=await this.genAsync.curve(e,t);return this.draw(l),l}},{key:'path',value:async function(e,t){var l=await this.genAsync.path(e,t);return this.draw(l),l}},{key:'generator',get:function(){return this.genAsync}}]),t}(N),F='undefined'!=typeof document,M=function(){function e(t,l){u(this,e),this.svg=t,this.gen=new R(l||null,this.svg)}return y(e,[{key:'line',value:function(e,t,l,a,n){var i=this.gen.line(e,t,l,a,n);return this.draw(i)}},{key:'rectangle',value:function(e,t,l,a,n){var i=this.gen.rectangle(e,t,l,a,n);return this.draw(i)}},{key:'ellipse',value:function(e,t,l,a,n){var i=this.gen.ellipse(e,t,l,a,n);return this.draw(i)}},{key:'circle',value:function(e,t,l,a){var n=this.gen.circle(e,t,l,a);return this.draw(n)}},{key:'linearPath',value:function(e,t){var l=this.gen.linearPath(e,t);return this.draw(l)}},{key:'polygon',value:function(e,t){var l=this.gen.polygon(e,t);return this.draw(l)}},{key:'arc',value:function(e,t,l,a,n,i){var s=!!(6<arguments.length&&void 0!==arguments[6])&&arguments[6],o=arguments[7],r=this.gen.arc(e,t,l,a,n,i,s,o);return this.draw(r)}},{key:'curve',value:function(e,t){var l=this.gen.curve(e,t);return this.draw(l)}},{key:'path',value:function(e,t){var l=this.gen.path(e,t);return this.draw(l)}},{key:'draw',value:function(e){var t=e.sets||[],l=e.options||this.gen.defaultOptions,n=this.svg.ownerDocument||F&&document,i=n.createElementNS('http://www.w3.org/2000/svg','g'),s=!0,o=!1,p=void 0;try{for(var d,h=t[Symbol.iterator]();!(s=(d=h.next()).done);s=!0){var g=d.value,f=null;switch(g.type){case'path':{f=n.createElementNS('http://www.w3.org/2000/svg','path'),f.setAttribute('d',this.opsToPath(g)),f.style.stroke=l.stroke,f.style.strokeWidth=l.strokeWidth+'',f.style.fill='none';break}case'fillPath':{f=n.createElementNS('http://www.w3.org/2000/svg','path'),f.setAttribute('d',this.opsToPath(g)),f.style.stroke='none',f.style.strokeWidth='0',f.style.fill=l.fill;break}case'fillSketch':{f=this.fillSketch(n,g,l);break}case'path2Dfill':{f=n.createElementNS('http://www.w3.org/2000/svg','path'),f.setAttribute('d',g.path||''),f.style.stroke='none',f.style.strokeWidth='0',f.style.fill=l.fill;break}case'path2Dpattern':{var u=g.size,y=n.createElementNS('http://www.w3.org/2000/svg','pattern'),c='rough-'+r(Math.random()*(Number.MAX_SAFE_INTEGER||999999));y.setAttribute('id',c),y.setAttribute('x','0'),y.setAttribute('y','0'),y.setAttribute('width','1'),y.setAttribute('height','1'),y.setAttribute('height','1'),y.setAttribute('viewBox','0 0 '+a(u[0])+' '+a(u[1])),y.setAttribute('patternUnits','objectBoundingBox');var v=this.fillSketch(n,g,l);y.appendChild(v),this.defs.appendChild(y),f=n.createElementNS('http://www.w3.org/2000/svg','path'),f.setAttribute('d',g.path||''),f.style.stroke='none',f.style.strokeWidth='0',f.style.fill='url(#'+c+')';break}}f&&i.appendChild(f)}}catch(e){o=!0,p=e}finally{try{!s&&h.return&&h.return()}finally{if(o)throw p}}return i}},{key:'opsToPath',value:function(e){return this.gen.opsToPath(e)}},{key:'fillSketch',value:function(e,t,l){var a=l.fillWeight;0>a&&(a=l.strokeWidth/2);var n=e.createElementNS('http://www.w3.org/2000/svg','path');return n.setAttribute('d',this.opsToPath(t)),n.style.stroke=l.fill,n.style.strokeWidth=a+'',n.style.fill='none',n}},{key:'generator',get:function(){return this.gen}},{key:'defs',get:function(){if(F&&!this._defs){var e=this.svg.ownerDocument||document,t=e.createElementNS('http://www.w3.org/2000/svg','defs');this.svg.firstChild?this.svg.insertBefore(t,this.svg.firstChild):this.svg.appendChild(t),this._defs=t}return this._defs||null}}],[{key:'createRenderer',value:function(){return new C}}]),e}(),q=function(e){function t(e,l){u(this,t);var a=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l));return a.genAsync=new D(l||null,a.svg),a}return c(t,e),y(t,[{key:'line',value:async function(e,t,l,a,n){var i=await this.genAsync.line(e,t,l,a,n);return this.draw(i)}},{key:'rectangle',value:async function(e,t,l,a,n){var i=await this.genAsync.rectangle(e,t,l,a,n);return this.draw(i)}},{key:'ellipse',value:async function(e,t,l,a,n){var i=await this.genAsync.ellipse(e,t,l,a,n);return this.draw(i)}},{key:'circle',value:async function(e,t,l,a){var n=await this.genAsync.circle(e,t,l,a);return this.draw(n)}},{key:'linearPath',value:async function(e,t){var l=await this.genAsync.linearPath(e,t);return this.draw(l)}},{key:'polygon',value:async function(e,t){var l=await this.genAsync.polygon(e,t);return this.draw(l)}},{key:'arc',value:async function(e,t,l,a,n,i){var s=!!(6<arguments.length&&void 0!==arguments[6])&&arguments[6],o=arguments[7],r=await this.genAsync.arc(e,t,l,a,n,i,s,o);return this.draw(r)}},{key:'curve',value:async function(e,t){var l=await this.genAsync.curve(e,t);return this.draw(l)}},{key:'path',value:async function(e,t){var l=await this.genAsync.path(e,t);return this.draw(l)}},{key:'generator',get:function(){return this.genAsync}}]),t}(M);return{canvas:function(e,t){return t&&t.async?new B(e,t):new N(e,t)},svg:function(e,t){return t&&t.async?new q(e,t):new M(e,t)},createRenderer:function(){return N.createRenderer()},generator:function(e,t){return e&&e.async?new D(e,t):new R(e,t)}}});
