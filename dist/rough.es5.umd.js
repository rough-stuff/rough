!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).rough=e()}(this,function(){"use strict";var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};function e(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}var i="undefined"!=typeof self,r=function(){function t(t,e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1},this.config=t||{},this.surface=e,this.config.options&&(this.defaultOptions=this._options(this.config.options))}return t.prototype._options=function(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions},t.prototype._drawable=function(t,e,i){return{shape:t,sets:e||[],options:i||this.defaultOptions}},t.prototype.getCanvasSize=function(){var t=function(t){return t&&"object"==typeof t&&t.baseVal&&t.baseVal.value?t.baseVal.value:t||100};return this.surface?[t(this.surface.width),t(this.surface.height)]:[100,100]},t.prototype.computePolygonSize=function(t){if(t.length){for(var e=t[0][0],i=t[0][0],r=t[0][1],s=t[0][1],n=1;n<t.length;n++)e=Math.min(e,t[n][0]),i=Math.max(i,t[n][0]),r=Math.min(r,t[n][1]),s=Math.max(s,t[n][1]);return[i-e,s-r]}return[0,0]},t.prototype.polygonPath=function(t){var e="";if(t.length){e="M"+t[0][0]+","+t[0][1];for(var i=1;i<t.length;i++)e=e+" L"+t[i][0]+","+t[i][1]}return e},t.prototype.computePathSize=function(t){var e=[0,0];if(i&&self.document)try{var r="http://www.w3.org/2000/svg",s=self.document.createElementNS(r,"svg");s.setAttribute("width","0"),s.setAttribute("height","0");var n=self.document.createElementNS(r,"path");n.setAttribute("d",t),s.appendChild(n),self.document.body.appendChild(s);var a=n.getBBox();a&&(e[0]=a.width||0,e[1]=a.height||0),self.document.body.removeChild(s)}catch(t){}var h=this.getCanvasSize();return e[0]*e[1]||(e=h),e},t.prototype.toPaths=function(t){for(var e=t.sets||[],i=t.options||this.defaultOptions,r=[],s=0,n=e;s<n.length;s++){var a=n[s],h=null;switch(a.type){case"path":h={d:this.opsToPath(a),stroke:i.stroke,strokeWidth:i.strokeWidth,fill:"none"};break;case"fillPath":h={d:this.opsToPath(a),stroke:"none",strokeWidth:0,fill:i.fill||"none"};break;case"fillSketch":h=this.fillSketch(a,i);break;case"path2Dfill":h={d:a.path||"",stroke:"none",strokeWidth:0,fill:i.fill||"none"};break;case"path2Dpattern":var o=a.size,p={x:0,y:0,width:1,height:1,viewBox:"0 0 "+Math.round(o[0])+" "+Math.round(o[1]),patternUnits:"objectBoundingBox",path:this.fillSketch(a,i)};h={d:a.path,stroke:"none",strokeWidth:0,pattern:p}}h&&r.push(h)}return r},t.prototype.fillSketch=function(t,e){var i=e.fillWeight;return i<0&&(i=e.strokeWidth/2),{d:this.opsToPath(t),stroke:e.fill||"none",strokeWidth:i,fill:"none"}},t.prototype.opsToPath=function(t){for(var e="",i=0,r=t.ops;i<r.length;i++){var s=r[i],n=s.data;switch(s.op){case"move":e+="M"+n[0]+" "+n[1]+" ";break;case"bcurveTo":e+="C"+n[0]+" "+n[1]+", "+n[2]+" "+n[3]+", "+n[4]+" "+n[5]+" ";break;case"qcurveTo":e+="Q"+n[0]+" "+n[1]+", "+n[2]+" "+n[3]+" ";break;case"lineTo":e+="L"+n[0]+" "+n[1]+" "}}return e.trim()},t}();function s(t,e){return t.type===e}var n={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:4,t:2,V:1,v:1,Z:0,z:0},a=function(){function t(t){this.COMMAND=0,this.NUMBER=1,this.EOD=2,this.segments=[],this.parseData(t),this.processPoints()}return t.prototype.tokenize=function(t){for(var e=new Array;""!==t;)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]={type:this.COMMAND,text:RegExp.$1},t=t.substr(RegExp.$1.length);else{if(!t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return console.error("Unrecognized segment command: "+t),[];e[e.length]={type:this.NUMBER,text:""+parseFloat(RegExp.$1)},t=t.substr(RegExp.$1.length)}return e[e.length]={type:this.EOD,text:""},e},t.prototype.parseData=function(t){var e=this.tokenize(t),i=0,r=e[i],a="BOD";for(this.segments=new Array;!s(r,this.EOD);){var h=void 0,o=new Array;if("BOD"===a){if("M"!==r.text&&"m"!==r.text)return void this.parseData("M0,0"+t);i++,h=n[r.text],a=r.text}else s(r,this.NUMBER)?h=n[a]:(i++,h=n[r.text],a=r.text);if(i+h<e.length){for(var p=i;p<i+h;p++){var l=e[p];if(!s(l,this.NUMBER))return void console.error("Parameter type is not a number: "+a+","+l.text);o[o.length]=+l.text}if("number"!=typeof n[a])return void console.error("Unsupported segment type: "+a);var u={key:a,data:o};this.segments.push(u),r=e[i+=h],"M"===a&&(a="L"),"m"===a&&(a="l")}else console.error("Path data ended before all parameters were found")}},Object.defineProperty(t.prototype,"closed",{get:function(){if(void 0===this._closed){this._closed=!1;for(var t=0,e=this.segments;t<e.length;t++){"z"===e[t].key.toLowerCase()&&(this._closed=!0)}}return this._closed},enumerable:!0,configurable:!0}),t.prototype.processPoints=function(){for(var t=null,e=[0,0],i=0;i<this.segments.length;i++){var r=this.segments[i];switch(r.key){case"M":case"L":case"T":r.point=[r.data[0],r.data[1]];break;case"m":case"l":case"t":r.point=[r.data[0]+e[0],r.data[1]+e[1]];break;case"H":r.point=[r.data[0],e[1]];break;case"h":r.point=[r.data[0]+e[0],e[1]];break;case"V":r.point=[e[0],r.data[0]];break;case"v":r.point=[e[0],r.data[0]+e[1]];break;case"z":case"Z":t&&(r.point=[t[0],t[1]]);break;case"C":r.point=[r.data[4],r.data[5]];break;case"c":r.point=[r.data[4]+e[0],r.data[5]+e[1]];break;case"S":r.point=[r.data[2],r.data[3]];break;case"s":r.point=[r.data[2]+e[0],r.data[3]+e[1]];break;case"Q":r.point=[r.data[2],r.data[3]];break;case"q":r.point=[r.data[2]+e[0],r.data[3]+e[1]];break;case"A":r.point=[r.data[5],r.data[6]];break;case"a":r.point=[r.data[5]+e[0],r.data[6]+e[1]]}"m"!==r.key&&"M"!==r.key||(t=null),r.point&&(e=r.point,t||(t=r.point)),"z"!==r.key&&"Z"!==r.key||(t=null)}},t}(),h=function(){function t(t){this._position=[0,0],this._first=null,this.bezierReflectionPoint=null,this.quadReflectionPoint=null,this.parsed=new a(t)}return Object.defineProperty(t.prototype,"segments",{get:function(){return this.parsed.segments},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"closed",{get:function(){return this.parsed.closed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"linearPoints",{get:function(){if(!this._linearPoints){for(var t=[],e=[],i=0,r=this.parsed.segments;i<r.length;i++){var s=r[i],n=s.key.toLowerCase();("m"!==n&&"z"!==n||(e.length&&(t.push(e),e=[]),"z"!==n))&&(s.point&&e.push(s.point))}e.length&&(t.push(e),e=[]),this._linearPoints=t}return this._linearPoints},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"first",{get:function(){return this._first},set:function(t){this._first=t},enumerable:!0,configurable:!0}),t.prototype.setPosition=function(t,e){this._position=[t,e],this._first||(this._first=[t,e])},Object.defineProperty(t.prototype,"position",{get:function(){return this._position},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._position[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._position[1]},enumerable:!0,configurable:!0}),t}(),o=function(){function t(t,e,i,r,s,n){if(this._segIndex=0,this._numSegs=0,this._rx=0,this._ry=0,this._sinPhi=0,this._cosPhi=0,this._C=[0,0],this._theta=0,this._delta=0,this._T=0,this._from=t,t[0]!==e[0]||t[1]!==e[1]){var a=Math.PI/180;this._rx=Math.abs(i[0]),this._ry=Math.abs(i[1]),this._sinPhi=Math.sin(r*a),this._cosPhi=Math.cos(r*a);var h=this._cosPhi*(t[0]-e[0])/2+this._sinPhi*(t[1]-e[1])/2,o=-this._sinPhi*(t[0]-e[0])/2+this._cosPhi*(t[1]-e[1])/2,p=0,l=this._rx*this._rx*this._ry*this._ry-this._rx*this._rx*o*o-this._ry*this._ry*h*h;if(l<0){var u=Math.sqrt(1-l/(this._rx*this._rx*this._ry*this._ry));this._rx=this._rx*u,this._ry=this._ry*u,p=0}else p=(s===n?-1:1)*Math.sqrt(l/(this._rx*this._rx*o*o+this._ry*this._ry*h*h));var c=p*this._rx*o/this._ry,f=-p*this._ry*h/this._rx;this._C=[0,0],this._C[0]=this._cosPhi*c-this._sinPhi*f+(t[0]+e[0])/2,this._C[1]=this._sinPhi*c+this._cosPhi*f+(t[1]+e[1])/2,this._theta=this.calculateVectorAngle(1,0,(h-c)/this._rx,(o-f)/this._ry);var d=this.calculateVectorAngle((h-c)/this._rx,(o-f)/this._ry,(-h-c)/this._rx,(-o-f)/this._ry);!n&&d>0?d-=2*Math.PI:n&&d<0&&(d+=2*Math.PI),this._numSegs=Math.ceil(Math.abs(d/(Math.PI/2))),this._delta=d/this._numSegs,this._T=8/3*Math.sin(this._delta/4)*Math.sin(this._delta/4)/Math.sin(this._delta/2)}}return t.prototype.getNextSegment=function(){if(this._segIndex===this._numSegs)return null;var t=Math.cos(this._theta),e=Math.sin(this._theta),i=this._theta+this._delta,r=Math.cos(i),s=Math.sin(i),n=[this._cosPhi*this._rx*r-this._sinPhi*this._ry*s+this._C[0],this._sinPhi*this._rx*r+this._cosPhi*this._ry*s+this._C[1]],a=[this._from[0]+this._T*(-this._cosPhi*this._rx*e-this._sinPhi*this._ry*t),this._from[1]+this._T*(-this._sinPhi*this._rx*e+this._cosPhi*this._ry*t)],h=[n[0]+this._T*(this._cosPhi*this._rx*s+this._sinPhi*this._ry*r),n[1]+this._T*(this._sinPhi*this._rx*s-this._cosPhi*this._ry*r)];return this._theta=i,this._from=[n[0],n[1]],this._segIndex++,{cp1:a,cp2:h,to:n}},t.prototype.calculateVectorAngle=function(t,e,i,r){var s=Math.atan2(e,t),n=Math.atan2(r,i);return n>=s?n-s:2*Math.PI-(s-n)},t}(),p=function(){function t(t,e){this.sets=t,this.closed=e}return t.prototype.fit=function(t){for(var e=[],i=0,r=this.sets;i<r.length;i++){var s=(p=r[i]).length,n=Math.floor(t*s);if(n<5){if(s<=5)continue;n=5}e.push(this.reduce(p,n))}for(var a="",h=0,o=e;h<o.length;h++){for(var p=o[h],l=0;l<p.length;l++){var u=p[l];a+=0===l?"M"+u[0]+","+u[1]:"L"+u[0]+","+u[1]}this.closed&&(a+="z ")}return a},t.prototype.distance=function(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))},t.prototype.reduce=function(t,e){if(t.length<=e)return t;for(var i=t.slice(0);i.length>e;){for(var r=[],s=-1,n=-1,a=1;a<i.length-1;a++){var h=this.distance(i[a-1],i[a]),o=this.distance(i[a],i[a+1]),p=this.distance(i[a-1],i[a+1]),l=(h+o+p)/2,u=Math.sqrt(l*(l-h)*(l-o)*(l-p));r.push(u),(s<0||u<s)&&(s=u,n=a)}if(!(n>0))break;i.splice(n,1)}return i},t}(),l=function(){function t(t,e){this.xi=Number.MAX_VALUE,this.yi=Number.MAX_VALUE,this.px1=t[0],this.py1=t[1],this.px2=e[0],this.py2=e[1],this.a=this.py2-this.py1,this.b=this.px1-this.px2,this.c=this.px2*this.py1-this.px1*this.py2,this._undefined=0===this.a&&0===this.b&&0===this.c}return t.prototype.isUndefined=function(){return this._undefined},t.prototype.intersects=function(t){if(this.isUndefined()||t.isUndefined())return!1;var e=Number.MAX_VALUE,i=Number.MAX_VALUE,r=0,s=0,n=this.a,a=this.b,h=this.c;return Math.abs(a)>1e-5&&(e=-n/a,r=-h/a),Math.abs(t.b)>1e-5&&(i=-t.a/t.b,s=-t.c/t.b),e===Number.MAX_VALUE?i===Number.MAX_VALUE?-h/n==-t.c/t.a&&(this.py1>=Math.min(t.py1,t.py2)&&this.py1<=Math.max(t.py1,t.py2)?(this.xi=this.px1,this.yi=this.py1,!0):this.py2>=Math.min(t.py1,t.py2)&&this.py2<=Math.max(t.py1,t.py2)&&(this.xi=this.px2,this.yi=this.py2,!0)):(this.xi=this.px1,this.yi=i*this.xi+s,!((this.py1-this.yi)*(this.yi-this.py2)<-1e-5||(t.py1-this.yi)*(this.yi-t.py2)<-1e-5)&&(!(Math.abs(t.a)<1e-5)||!((t.px1-this.xi)*(this.xi-t.px2)<-1e-5))):i===Number.MAX_VALUE?(this.xi=t.px1,this.yi=e*this.xi+r,!((t.py1-this.yi)*(this.yi-t.py2)<-1e-5||(this.py1-this.yi)*(this.yi-this.py2)<-1e-5)&&(!(Math.abs(n)<1e-5)||!((this.px1-this.xi)*(this.xi-this.px2)<-1e-5))):e===i?r===s&&(this.px1>=Math.min(t.px1,t.px2)&&this.px1<=Math.max(t.py1,t.py2)?(this.xi=this.px1,this.yi=this.py1,!0):this.px2>=Math.min(t.px1,t.px2)&&this.px2<=Math.max(t.px1,t.px2)&&(this.xi=this.px2,this.yi=this.py2,!0)):(this.xi=(s-r)/(e-i),this.yi=e*this.xi+r,!((this.px1-this.xi)*(this.xi-this.px2)<-1e-5||(t.px1-this.xi)*(this.xi-t.px2)<-1e-5))},t}();var u=function(){function t(t,e,i,r,s,n,a,h){this.deltaX=0,this.hGap=0,this.top=t,this.bottom=e,this.left=i,this.right=r,this.gap=s,this.sinAngle=n,this.tanAngle=h,Math.abs(n)<1e-4?this.pos=i+s:Math.abs(n)>.9999?this.pos=t+s:(this.deltaX=(e-t)*Math.abs(h),this.pos=i-Math.abs(this.deltaX),this.hGap=Math.abs(s/a),this.sLeft=new l([i,e],[i,t]),this.sRight=new l([r,e],[r,t]))}return t.prototype.nextLine=function(){if(Math.abs(this.sinAngle)<1e-4){if(this.pos<this.right){var t=[this.pos,this.top,this.pos,this.bottom];return this.pos+=this.gap,t}}else if(Math.abs(this.sinAngle)>.9999){if(this.pos<this.bottom){t=[this.left,this.pos,this.right,this.pos];return this.pos+=this.gap,t}}else{var e=this.pos-this.deltaX/2,i=this.pos+this.deltaX/2,r=this.bottom,s=this.top;if(this.pos<this.right+this.deltaX){for(;e<this.left&&i<this.left||e>this.right&&i>this.right;)if(this.pos+=this.hGap,e=this.pos-this.deltaX/2,i=this.pos+this.deltaX/2,this.pos>this.right+this.deltaX)return null;var n=new l([e,r],[i,s]);this.sLeft&&n.intersects(this.sLeft)&&(e=n.xi,r=n.yi),this.sRight&&n.intersects(this.sRight)&&(i=n.xi,s=n.yi),this.tanAngle>0&&(e=this.right-(e-this.left),i=this.right-(i-this.left));t=[e,r,i,s];return this.pos+=this.hGap,t}}return null},t}();function c(t){var e=t[0],i=t[1];return Math.sqrt(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2))}function f(t,e){for(var i=[],r=new l([t[0],t[1]],[t[2],t[3]]),s=0;s<e.length;s++){var n=new l(e[s],e[(s+1)%e.length]);r.intersects(n)&&i.push([r.xi,r.yi])}return i}function d(t,e,i,r,s,n,a){return[-i*n-r*s+i+n*t+s*e,a*(i*s-r*n)+r+-a*s*t+a*n*e]}function y(t,e){var i=[];if(t&&t.length){for(var r=t[0][0],s=t[0][0],n=t[0][1],a=t[0][1],h=1;h<t.length;h++)r=Math.min(r,t[h][0]),s=Math.max(s,t[h][0]),n=Math.min(n,t[h][1]),a=Math.max(a,t[h][1]);var o=e.hachureAngle,p=e.hachureGap;p<0&&(p=4*e.strokeWidth),p=Math.max(p,.1);for(var l=o%180*(Math.PI/180),c=Math.cos(l),d=Math.sin(l),y=Math.tan(l),g=new u(n-1,a+1,r-1,s+1,p,d,c,y),v=void 0;null!=(v=g.nextLine());){var M=f(v,t);for(h=0;h<M.length;h++)if(h<M.length-1){var b=M[h],m=M[h+1];i.push([b,m])}}}return i}function g(t,e,i,r,s,n){var a=[],h=Math.abs(r/2),o=Math.abs(s/2);h+=t.randOffset(.05*h,n),o+=t.randOffset(.05*o,n);var p=n.hachureAngle,l=n.hachureGap;l<=0&&(l=4*n.strokeWidth);var u=n.fillWeight;u<0&&(u=n.strokeWidth/2);for(var c=p%180*(Math.PI/180),f=Math.tan(c),y=o/h,g=Math.sqrt(y*f*y*f+1),v=y*f/g,M=1/g,b=l/(h*o/Math.sqrt(o*M*(o*M)+h*v*(h*v))/h),m=Math.sqrt(h*h-(e-h+b)*(e-h+b)),_=e-h+b;_<e+h;_+=b){var x=d(_,i-(m=Math.sqrt(h*h-(e-_)*(e-_))),e,i,v,M,y),w=d(_,i+m,e,i,v,M,y);a.push([x,w])}return a}var v=function(){function t(t){this.helper=t}return t.prototype.fillPolygon=function(t,e){return this._fillPolygon(t,e)},t.prototype.fillEllipse=function(t,e,i,r,s){return this._fillEllipse(t,e,i,r,s)},t.prototype.fillArc=function(t,e,i,r,s,n,a){return null},t.prototype._fillPolygon=function(t,e,i){void 0===i&&(i=!1);var r=y(t,e);return{type:"fillSketch",ops:this.renderLines(r,e,i)}},t.prototype._fillEllipse=function(t,e,i,r,s,n){void 0===n&&(n=!1);var a=g(this.helper,t,e,i,r,s);return{type:"fillSketch",ops:this.renderLines(a,s,n)}},t.prototype.renderLines=function(t,e,i){for(var r=[],s=null,n=0,a=t;n<a.length;n++){var h=a[n];r=r.concat(this.helper.doubleLineOps(h[0][0],h[0][1],h[1][0],h[1][1],e)),i&&s&&(r=r.concat(this.helper.doubleLineOps(s[0],s[1],h[0][0],h[0][1],e))),s=h[1]}return r},t}(),M=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.fillPolygon=function(t,e){return this._fillPolygon(t,e,!0)},i.prototype.fillEllipse=function(t,e,i,r,s){return this._fillEllipse(t,e,i,r,s,!0)},i}(v),b=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.fillPolygon=function(t,e){var i=this._fillPolygon(t,e),r=Object.assign({},e,{hachureAngle:e.hachureAngle+90}),s=this._fillPolygon(t,r);return i.ops=i.ops.concat(s.ops),i},i.prototype.fillEllipse=function(t,e,i,r,s){var n=this._fillEllipse(t,e,i,r,s),a=Object.assign({},s,{hachureAngle:s.hachureAngle+90}),h=this._fillEllipse(t,e,i,r,a);return n.ops=n.ops.concat(h.ops),n},i}(v),m=function(){function t(t){this.helper=t}return t.prototype.fillPolygon=function(t,e){var i=y(t,e=Object.assign({},e,{curveStepCount:4,hachureAngle:0}));return this.dotsOnLines(i,e)},t.prototype.fillEllipse=function(t,e,i,r,s){s=Object.assign({},s,{curveStepCount:4,hachureAngle:0});var n=g(this.helper,t,e,i,r,s);return this.dotsOnLines(n,s)},t.prototype.fillArc=function(t,e,i,r,s,n,a){return null},t.prototype.dotsOnLines=function(t,e){var i=[],r=e.hachureGap;r<0&&(r=4*e.strokeWidth),r=Math.max(r,.1);var s=e.fillWeight;s<0&&(s=e.strokeWidth/2);for(var n=0,a=t;n<a.length;n++)for(var h=a[n],o=c(h)/r,p=Math.ceil(o)-1,l=Math.atan((h[1][1]-h[0][1])/(h[1][0]-h[0][0])),u=0;u<p;u++){var f=r*(u+1),d=f*Math.sin(l),y=f*Math.cos(l),g=[h[0][0]-y,h[0][1]+d],v=this.helper.randOffsetWithRange(g[0]-r/4,g[0]+r/4,e),M=this.helper.randOffsetWithRange(g[1]-r/4,g[1]+r/4,e),b=this.helper.ellipse(v,M,s,s,e);i=i.concat(b.ops)}return{type:"fillSketch",ops:i}},t}(),_=function(){function t(t){this.helper=t}return t.prototype.fillPolygon=function(t,e){var i=[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER],r=[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER];t.forEach(function(t){i[0]=Math.min(i[0],t[0]),i[1]=Math.max(i[1],t[0]),r[0]=Math.min(r[0],t[1]),r[1]=Math.max(r[1],t[1])});var s=function(t){for(var e=0,i=0,r=0,s=0;s<t.length;s++){var n=t[s],a=s===t.length-1?t[0]:t[s+1];e+=n[0]*a[1]-a[0]*n[1]}for(e/=2,s=0;s<t.length;s++)n=t[s],a=s===t.length-1?t[0]:t[s+1],i+=(n[0]+a[0])*(n[0]*a[1]-a[0]*n[1]),r+=(n[1]+a[1])*(n[0]*a[1]-a[0]*n[1]);return[i/(6*e),r/(6*e)]}(t),n=Math.max(Math.sqrt(Math.pow(s[0]-i[0],2)+Math.pow(s[1]-r[0],2)),Math.sqrt(Math.pow(s[0]-i[1],2)+Math.pow(s[1]-r[1],2))),a=e.hachureGap>0?e.hachureGap:4*e.strokeWidth,h=[];if(t.length>2)for(var o=0;o<t.length;o++)o===t.length-1?h.push([t[o],t[0]]):h.push([t[o],t[o+1]]);var p=[],l=Math.max(1,Math.PI*n/a),u=function(t){var e=t*Math.PI/l,a=[s,[s[0]+n*Math.cos(e),s[1]+n*Math.sin(e)]];h.forEach(function(t){var e,s,n,h,o,l,u,c,f,d=(s=a,n=(e=t)[1][1]-e[0][1],h=e[0][0]-e[1][0],o=n*e[0][0]+h*e[0][1],l=s[1][1]-s[0][1],u=s[0][0]-s[1][0],c=l*s[0][0]+u*s[0][1],(f=n*u-l*h)?[Math.round((u*o-h*c)/f),Math.round((n*c-l*o)/f)]:null);d&&d[0]>=i[0]&&d[0]<=i[1]&&d[1]>=r[0]&&d[1]<=r[1]&&p.push(d)})};for(o=0;o<l;o++)u(o);p=this.removeDuplocatePoints(p);var c=this.createLinesFromCenter(s,p);return{type:"fillSketch",ops:this.drawLines(c,e)}},t.prototype.fillEllipse=function(t,e,i,r,s){return this.fillArcSegment(t,e,i,r,0,2*Math.PI,s)},t.prototype.fillArc=function(t,e,i,r,s,n,a){return this.fillArcSegment(t,e,i,r,s,n,a)},t.prototype.fillArcSegment=function(t,e,i,r,s,n,a){var h=[t,e],o=i/2,p=r/2,l=Math.max(i/2,r/2),u=a.hachureGap;u<0&&(u=4*a.strokeWidth);for(var c=Math.max(1,Math.abs(n-s)*l/u),f=[],d=0;d<c;d++){var y=d*((n-s)/c)+s,g=l*Math.cos(y),v=l*Math.sin(y),M=Math.sqrt(o*o*v*v+p*p*g*g),b=o*p*g/M,m=o*p*v/M;f.push([h[0]+b,h[1]+m])}f=this.removeDuplocatePoints(f);var _=this.createLinesFromCenter(h,f);return{type:"fillSketch",ops:this.drawLines(_,a)}},t.prototype.drawLines=function(t,e){var i=this,r=[];return t.forEach(function(t){var s=t[0],n=t[1];r=r.concat(i.helper.doubleLineOps(s[0],s[1],n[0],n[1],e))}),r},t.prototype.createLinesFromCenter=function(t,e){return e.map(function(e){return[t,e]})},t.prototype.removeDuplocatePoints=function(t){var e=new Set;return t.filter(function(t){var i=t.join(",");return!e.has(i)&&(e.add(i),!0)})},t}(),x=function(){function t(t){this.helper=t}return t.prototype.fillPolygon=function(t,e){var i=y(t,e);return{type:"fillSketch",ops:this.dashedLine(i,e)}},t.prototype.fillEllipse=function(t,e,i,r,s){var n=g(this.helper,t,e,i,r,s);return{type:"fillSketch",ops:this.dashedLine(n,s)}},t.prototype.fillArc=function(t,e,i,r,s,n,a){return null},t.prototype.dashedLine=function(t,e){var i=this,r=e.dashOffset<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashOffset,s=e.dashGap<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashGap,n=[];return t.forEach(function(t){var a=c(t),h=Math.floor(a/(r+s)),o=(a+s-h*(r+s))/2,p=t[0],l=t[1];p[0]>l[0]&&(p=t[1],l=t[0]);for(var u=Math.atan((l[1]-p[1])/(l[0]-p[0])),f=0;f<h;f++){var d=f*(r+s),y=d+r,g=[p[0]+d*Math.cos(u)+o*Math.cos(u),p[1]+d*Math.sin(u)+o*Math.sin(u)],v=[p[0]+y*Math.cos(u)+o*Math.cos(u),p[1]+y*Math.sin(u)+o*Math.sin(u)];n=n.concat(i.helper.doubleLineOps(g[0],g[1],v[0],v[1],e))}}),n},t}(),w=function(){function t(t){this.helper=t}return t.prototype.fillPolygon=function(t,e){var i=e.hachureGap<0?4*e.strokeWidth:e.hachureGap,r=e.zigzagOffset<0?i:e.zigzagOffset,s=y(t,e=Object.assign({},e,{hachureGap:i+r}));return{type:"fillSketch",ops:this.zigzagLines(s,r,e)}},t.prototype.fillEllipse=function(t,e,i,r,s){var n=s.hachureGap<0?4*s.strokeWidth:s.hachureGap,a=s.zigzagOffset<0?n:s.zigzagOffset;s=Object.assign({},s,{hachureGap:n+a});var h=g(this.helper,t,e,i,r,s);return{type:"fillSketch",ops:this.zigzagLines(h,a,s)}},t.prototype.fillArc=function(t,e,i,r,s,n,a){return null},t.prototype.zigzagLines=function(t,e,i){var r=this,s=[];return t.forEach(function(t){var n=c(t),a=Math.round(n/(2*e)),h=t[0],o=t[1];h[0]>o[0]&&(h=t[1],o=t[0]);for(var p=Math.atan((o[1]-h[1])/(o[0]-h[0])),l=0;l<a;l++){var u=2*l*e,f=2*(l+1)*e,d=Math.sqrt(2*Math.pow(e,2)),y=[h[0]+u*Math.cos(p),h[1]+u*Math.sin(p)],g=[h[0]+f*Math.cos(p),h[1]+f*Math.sin(p)],v=[y[0]+d*Math.cos(p+Math.PI/4),y[1]+d*Math.sin(p+Math.PI/4)];s=(s=s.concat(r.helper.doubleLineOps(y[0],y[1],v[0],v[1],i))).concat(r.helper.doubleLineOps(v[0],v[1],g[0],g[1],i))}}),s},t}(),P={};function k(t,e){var i=t.fillStyle||"hachure";if(!P[i])switch(i){case"zigzag":P[i]||(P[i]=new M(e));break;case"cross-hatch":P[i]||(P[i]=new b(e));break;case"dots":P[i]||(P[i]=new m(e));break;case"starburst":P[i]||(P[i]=new _(e));break;case"dashed":P[i]||(P[i]=new x(e));break;case"zigzag-line":P[i]||(P[i]=new w(e));break;case"hachure":default:P[i="hachure"]||(P[i]=new v(e))}return P[i]}var S={randOffset:function(t,e){return R(t,e)},randOffsetWithRange:function(t,e,i){return W(t,e,i)},ellipse:C,doubleLineOps:function(t,e,i,r,s){return I(t,e,i,r,s)}};function A(t,e,i,r,s){return{type:"path",ops:I(t,e,i,r,s)}}function O(t,e,i){var r=(t||[]).length;if(r>2){for(var s=[],n=0;n<r-1;n++)s=s.concat(I(t[n][0],t[n][1],t[n+1][0],t[n+1][1],i));return e&&(s=s.concat(I(t[r-1][0],t[r-1][1],t[0][0],t[0][1],i))),{type:"path",ops:s}}return 2===r?A(t[0][0],t[0][1],t[1][0],t[1][1],i):{type:"path",ops:[]}}function E(t,e,i,r,s){return function(t,e){return O(t,!0,e)}([[t,e],[t+i,e],[t+i,e+r],[t,e+r]],s)}function T(t,e){var i=q(t,1*(1+.2*e.roughness),e),r=q(t,1.5*(1+.22*e.roughness),e);return{type:"path",ops:i.concat(r)}}function C(t,e,i,r,s){var n=2*Math.PI/s.curveStepCount,a=Math.abs(i/2),h=Math.abs(r/2),o=j(n,t,e,a+=R(.05*a,s),h+=R(.05*h,s),1,n*W(.1,W(.4,1,s),s),s),p=j(n,t,e,a,h,1.5,0,s);return{type:"path",ops:o.concat(p)}}function z(t,e,i,r,s,n,a,h,o){var p=t,l=e,u=Math.abs(i/2),c=Math.abs(r/2);u+=R(.01*u,o),c+=R(.01*c,o);for(var f=s,d=n;f<0;)f+=2*Math.PI,d+=2*Math.PI;d-f>2*Math.PI&&(f=0,d=2*Math.PI);var y=2*Math.PI/o.curveStepCount,g=Math.min(y/2,(d-f)/2),v=B(g,p,l,u,c,f,d,1,o),M=B(g,p,l,u,c,f,d,1.5,o),b=v.concat(M);return a&&(h?b=(b=b.concat(I(p,l,p+u*Math.cos(f),l+c*Math.sin(f),o))).concat(I(p,l,p+u*Math.cos(d),l+c*Math.sin(d),o)):(b.push({op:"lineTo",data:[p,l]}),b.push({op:"lineTo",data:[p+u*Math.cos(f),l+c*Math.sin(f)]}))),{type:"path",ops:b}}function L(t,e){var i=[];if(t.length){var r=e.maxRandomnessOffset||0,s=t.length;if(s>2){i.push({op:"move",data:[t[0][0]+R(r,e),t[0][1]+R(r,e)]});for(var n=1;n<s;n++)i.push({op:"lineTo",data:[t[n][0]+R(r,e),t[n][1]+R(r,e)]})}}return{type:"fillPath",ops:i}}function N(t,e){return k(e,S).fillPolygon(t,e)}function W(t,e,i){return i.roughness*(Math.random()*(e-t)+t)}function R(t,e){return W(-t,t,e)}function I(t,e,i,r,s){var n=D(t,e,i,r,s,!0,!1),a=D(t,e,i,r,s,!0,!0);return n.concat(a)}function D(t,e,i,r,s,n,a){var h=Math.pow(t-i,2)+Math.pow(e-r,2),o=s.maxRandomnessOffset||0;o*o*100>h&&(o=Math.sqrt(h)/10);var p=o/2,l=.2+.2*Math.random(),u=s.bowing*s.maxRandomnessOffset*(r-e)/200,c=s.bowing*s.maxRandomnessOffset*(t-i)/200;u=R(u,s),c=R(c,s);var f=[],d=function(){return R(p,s)},y=function(){return R(o,s)};return n&&(a?f.push({op:"move",data:[t+d(),e+d()]}):f.push({op:"move",data:[t+R(o,s),e+R(o,s)]})),a?f.push({op:"bcurveTo",data:[u+t+(i-t)*l+d(),c+e+(r-e)*l+d(),u+t+2*(i-t)*l+d(),c+e+2*(r-e)*l+d(),i+d(),r+d()]}):f.push({op:"bcurveTo",data:[u+t+(i-t)*l+y(),c+e+(r-e)*l+y(),u+t+2*(i-t)*l+y(),c+e+2*(r-e)*l+y(),i+y(),r+y()]}),f}function q(t,e,i){var r=[];r.push([t[0][0]+R(e,i),t[0][1]+R(e,i)]),r.push([t[0][0]+R(e,i),t[0][1]+R(e,i)]);for(var s=1;s<t.length;s++)r.push([t[s][0]+R(e,i),t[s][1]+R(e,i)]),s===t.length-1&&r.push([t[s][0]+R(e,i),t[s][1]+R(e,i)]);return G(r,null,i)}function G(t,e,i){var r=t.length,s=[];if(r>3){var n=[],a=1-i.curveTightness;s.push({op:"move",data:[t[1][0],t[1][1]]});for(var h=1;h+2<r;h++){var o=t[h];n[0]=[o[0],o[1]],n[1]=[o[0]+(a*t[h+1][0]-a*t[h-1][0])/6,o[1]+(a*t[h+1][1]-a*t[h-1][1])/6],n[2]=[t[h+1][0]+(a*t[h][0]-a*t[h+2][0])/6,t[h+1][1]+(a*t[h][1]-a*t[h+2][1])/6],n[3]=[t[h+1][0],t[h+1][1]],s.push({op:"bcurveTo",data:[n[1][0],n[1][1],n[2][0],n[2][1],n[3][0],n[3][1]]})}if(e&&2===e.length){var p=i.maxRandomnessOffset;s.push({op:"lineTo",data:[e[0]+R(p,i),e[1]+R(p,i)]})}}else 3===r?(s.push({op:"move",data:[t[1][0],t[1][1]]}),s.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):2===r&&(s=s.concat(I(t[0][0],t[0][1],t[1][0],t[1][1],i)));return s}function j(t,e,i,r,s,n,a,h){var o=R(.5,h)-Math.PI/2,p=[];p.push([R(n,h)+e+.9*r*Math.cos(o-t),R(n,h)+i+.9*s*Math.sin(o-t)]);for(var l=o;l<2*Math.PI+o-.01;l+=t)p.push([R(n,h)+e+r*Math.cos(l),R(n,h)+i+s*Math.sin(l)]);return p.push([R(n,h)+e+r*Math.cos(o+2*Math.PI+.5*a),R(n,h)+i+s*Math.sin(o+2*Math.PI+.5*a)]),p.push([R(n,h)+e+.98*r*Math.cos(o+a),R(n,h)+i+.98*s*Math.sin(o+a)]),p.push([R(n,h)+e+.9*r*Math.cos(o+.5*a),R(n,h)+i+.9*s*Math.sin(o+.5*a)]),G(p,null,h)}function B(t,e,i,r,s,n,a,h,o){var p=n+R(.1,o),l=[];l.push([R(h,o)+e+.9*r*Math.cos(p-t),R(h,o)+i+.9*s*Math.sin(p-t)]);for(var u=p;u<=a;u+=t)l.push([R(h,o)+e+r*Math.cos(u),R(h,o)+i+s*Math.sin(u)]);return l.push([e+r*Math.cos(a),i+s*Math.sin(a)]),l.push([e+r*Math.cos(a),i+s*Math.sin(a)]),G(l,null,o)}function X(t,e,i,r,s,n,a,h){for(var o=[],p=[h.maxRandomnessOffset||1,(h.maxRandomnessOffset||1)+.5],l=[0,0],u=0;u<2;u++)0===u?o.push({op:"move",data:[a.x,a.y]}):o.push({op:"move",data:[a.x+R(p[0],h),a.y+R(p[0],h)]}),l=[s+R(p[u],h),n+R(p[u],h)],o.push({op:"bcurveTo",data:[t+R(p[u],h),e+R(p[u],h),i+R(p[u],h),r+R(p[u],h),l[0],l[1]]});return a.setPosition(l[0],l[1]),o}function U(t,e,i,r){var s=[];switch(e.key){case"M":case"m":var n="m"===e.key;if(e.data.length>=2){var a=+e.data[0],h=+e.data[1];n&&(a+=t.x,h+=t.y);var p=1*(r.maxRandomnessOffset||0);a+=R(p,r),h+=R(p,r),t.setPosition(a,h),s.push({op:"move",data:[a,h]})}break;case"L":case"l":n="l"===e.key;if(e.data.length>=2){a=+e.data[0],h=+e.data[1];n&&(a+=t.x,h+=t.y),s=s.concat(I(t.x,t.y,a,h,r)),t.setPosition(a,h)}break;case"H":case"h":n="h"===e.key;if(e.data.length){a=+e.data[0];n&&(a+=t.x),s=s.concat(I(t.x,t.y,a,t.y,r)),t.setPosition(a,t.y)}break;case"V":case"v":n="v"===e.key;if(e.data.length){h=+e.data[0];n&&(h+=t.y),s=s.concat(I(t.x,t.y,t.x,h,r)),t.setPosition(t.x,h)}break;case"Z":case"z":t.first&&(s=s.concat(I(t.x,t.y,t.first[0],t.first[1],r)),t.setPosition(t.first[0],t.first[1]),t.first=null);break;case"C":case"c":n="c"===e.key;if(e.data.length>=6){var l=+e.data[0],u=+e.data[1],c=+e.data[2],f=+e.data[3];a=+e.data[4],h=+e.data[5];n&&(l+=t.x,c+=t.x,a+=t.x,u+=t.y,f+=t.y,h+=t.y);var d=X(l,u,c,f,a,h,t,r);s=s.concat(d),t.bezierReflectionPoint=[a+(a-c),h+(h-f)]}break;case"S":case"s":n="s"===e.key;if(e.data.length>=4){c=+e.data[0],f=+e.data[1],a=+e.data[2],h=+e.data[3];n&&(c+=t.x,a+=t.x,f+=t.y,h+=t.y);l=c,u=f;var y=null;"c"!==(b=i?i.key:"")&&"C"!==b&&"s"!==b&&"S"!==b||(y=t.bezierReflectionPoint),y&&(l=y[0],u=y[1]);d=X(l,u,c,f,a,h,t,r);s=s.concat(d),t.bezierReflectionPoint=[a+(a-c),h+(h-f)]}break;case"Q":case"q":n="q"===e.key;if(e.data.length>=4){l=+e.data[0],u=+e.data[1],a=+e.data[2],h=+e.data[3];n&&(l+=t.x,a+=t.x,u+=t.y,h+=t.y);var g=1*(1+.2*r.roughness),v=1.5*(1+.22*r.roughness);s.push({op:"move",data:[t.x+R(g,r),t.y+R(g,r)]});var M=[a+R(g,r),h+R(g,r)];s.push({op:"qcurveTo",data:[l+R(g,r),u+R(g,r),M[0],M[1]]}),s.push({op:"move",data:[t.x+R(v,r),t.y+R(v,r)]}),M=[a+R(v,r),h+R(v,r)],s.push({op:"qcurveTo",data:[l+R(v,r),u+R(v,r),M[0],M[1]]}),t.setPosition(M[0],M[1]),t.quadReflectionPoint=[a+(a-l),h+(h-u)]}break;case"T":case"t":n="t"===e.key;if(e.data.length>=2){a=+e.data[0],h=+e.data[1];n&&(a+=t.x,h+=t.y);var b;l=a,u=h,y=null;"q"!==(b=i?i.key:"")&&"Q"!==b&&"t"!==b&&"T"!==b||(y=t.quadReflectionPoint),y&&(l=y[0],u=y[1]);g=1*(1+.2*r.roughness),v=1.5*(1+.22*r.roughness);s.push({op:"move",data:[t.x+R(g,r),t.y+R(g,r)]});M=[a+R(g,r),h+R(g,r)];s.push({op:"qcurveTo",data:[l+R(g,r),u+R(g,r),M[0],M[1]]}),s.push({op:"move",data:[t.x+R(v,r),t.y+R(v,r)]}),M=[a+R(v,r),h+R(v,r)],s.push({op:"qcurveTo",data:[l+R(v,r),u+R(v,r),M[0],M[1]]}),t.setPosition(M[0],M[1]),t.quadReflectionPoint=[a+(a-l),h+(h-u)]}break;case"A":case"a":n="a"===e.key;if(e.data.length>=7){var m=+e.data[0],_=+e.data[1],x=+e.data[2],w=+e.data[3],P=+e.data[4];a=+e.data[5],h=+e.data[6];if(n&&(a+=t.x,h+=t.y),a===t.x&&h===t.y)break;if(0===m||0===_)s=s.concat(I(t.x,t.y,a,h,r)),t.setPosition(a,h);else for(var k=0;k<1;k++)for(var S=new o([t.x,t.y],[a,h],[m,_],x,!!w,!!P),A=S.getNextSegment();A;){d=X(A.cp1[0],A.cp1[1],A.cp2[0],A.cp2[1],A.to[0],A.to[1],t,r);s=s.concat(d),A=S.getNextSegment()}}}return s}var V=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.line=function(t,e,i,r,s){var n=this._options(s);return this._drawable("line",[A(t,e,i,r,n)],n)},i.prototype.rectangle=function(t,e,i,r,s){var n=this._options(s),a=[];if(n.fill){var h=[[t,e],[t+i,e],[t+i,e+r],[t,e+r]];"solid"===n.fillStyle?a.push(L(h,n)):a.push(N(h,n))}return a.push(E(t,e,i,r,n)),this._drawable("rectangle",a,n)},i.prototype.ellipse=function(t,e,i,r,s){var n=this._options(s),a=[];if(n.fill)if("solid"===n.fillStyle){var h=C(t,e,i,r,n);h.type="fillPath",a.push(h)}else a.push(function(t,e,i,r,s){return k(s,S).fillEllipse(t,e,i,r,s)}(t,e,i,r,n));return a.push(C(t,e,i,r,n)),this._drawable("ellipse",a,n)},i.prototype.circle=function(t,e,i,r){var s=this.ellipse(t,e,i,i,r);return s.shape="circle",s},i.prototype.linearPath=function(t,e){var i=this._options(e);return this._drawable("linearPath",[O(t,!1,i)],i)},i.prototype.arc=function(t,e,i,r,s,n,a,h){void 0===a&&(a=!1);var o=this._options(h),p=[];if(a&&o.fill)if("solid"===o.fillStyle){var l=z(t,e,i,r,s,n,!0,!1,o);l.type="fillPath",p.push(l)}else p.push(function(t,e,i,r,s,n,a){var h=k(a,S).fillArc(t,e,i,r,s,n,a);if(h)return h;var o=t,p=e,l=Math.abs(i/2),u=Math.abs(r/2);l+=R(.01*l,a),u+=R(.01*u,a);for(var c=s,f=n;c<0;)c+=2*Math.PI,f+=2*Math.PI;f-c>2*Math.PI&&(c=0,f=2*Math.PI);for(var d=(f-c)/a.curveStepCount,y=[],g=c;g<=f;g+=d)y.push([o+l*Math.cos(g),p+u*Math.sin(g)]);return y.push([o+l*Math.cos(f),p+u*Math.sin(f)]),y.push([o,p]),N(y,a)}(t,e,i,r,s,n,o));return p.push(z(t,e,i,r,s,n,a,!0,o)),this._drawable("arc",p,o)},i.prototype.curve=function(t,e){var i=this._options(e);return this._drawable("curve",[T(t,i)],i)},i.prototype.polygon=function(t,e){var i=this._options(e),r=[];if(i.fill)if("solid"===i.fillStyle)r.push(L(t,i));else{var s=this.computePolygonSize(t),n=N([[0,0],[s[0],0],[s[0],s[1]],[0,s[1]]],i);n.type="path2Dpattern",n.size=s,n.path=this.polygonPath(t),r.push(n)}return r.push(O(t,!0,i)),this._drawable("polygon",r,i)},i.prototype.path=function(t,e){var i=this._options(e),r=[];if(!t)return this._drawable("path",r,i);if(i.fill)if("solid"===i.fillStyle){var s={type:"path2Dfill",path:t,ops:[]};r.push(s)}else{var n=this.computePathSize(t);(s=N([[0,0],[n[0],0],[n[0],n[1]],[0,n[1]]],i)).type="path2Dpattern",s.size=n,s.path=t,r.push(s)}return r.push(function(t,e){t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");var i=new h(t);if(e.simplification){var r=new p(i.linearPoints,i.closed).fit(e.simplification);i=new h(r)}for(var s=[],n=i.segments||[],a=0;a<n.length;a++){var o=U(i,n[a],a>0?n[a-1]:null,e);o&&o.length&&(s=s.concat(o))}return{type:"path",ops:s}}(t,i)),this._drawable("path",r,i)},i}(r),F="undefined"!=typeof document,Q=function(t){function i(e,i){var r=t.call(this,e)||this;return r.gen=new V(i||null,r.canvas),r}return e(i,t),Object.defineProperty(i.prototype,"generator",{get:function(){return this.gen},enumerable:!0,configurable:!0}),i.prototype.getDefaultOptions=function(){return this.gen.defaultOptions},i.prototype.line=function(t,e,i,r,s){var n=this.gen.line(t,e,i,r,s);return this.draw(n),n},i.prototype.rectangle=function(t,e,i,r,s){var n=this.gen.rectangle(t,e,i,r,s);return this.draw(n),n},i.prototype.ellipse=function(t,e,i,r,s){var n=this.gen.ellipse(t,e,i,r,s);return this.draw(n),n},i.prototype.circle=function(t,e,i,r){var s=this.gen.circle(t,e,i,r);return this.draw(s),s},i.prototype.linearPath=function(t,e){var i=this.gen.linearPath(t,e);return this.draw(i),i},i.prototype.polygon=function(t,e){var i=this.gen.polygon(t,e);return this.draw(i),i},i.prototype.arc=function(t,e,i,r,s,n,a,h){void 0===a&&(a=!1);var o=this.gen.arc(t,e,i,r,s,n,a,h);return this.draw(o),o},i.prototype.curve=function(t,e){var i=this.gen.curve(t,e);return this.draw(i),i},i.prototype.path=function(t,e){var i=this.gen.path(t,e);return this.draw(i),i},i}(function(){function t(t){this.canvas=t,this.ctx=this.canvas.getContext("2d")}return t.prototype.draw=function(t){for(var e=t.sets||[],i=t.options||this.getDefaultOptions(),r=this.ctx,s=0,n=e;s<n.length;s++){var a=n[s];switch(a.type){case"path":r.save(),r.strokeStyle=i.stroke,r.lineWidth=i.strokeWidth,this._drawToContext(r,a),r.restore();break;case"fillPath":r.save(),r.fillStyle=i.fill||"",this._drawToContext(r,a),r.restore();break;case"fillSketch":this.fillSketch(r,a,i);break;case"path2Dfill":this.ctx.save(),this.ctx.fillStyle=i.fill||"";var h=new Path2D(a.path);this.ctx.fill(h),this.ctx.restore();break;case"path2Dpattern":var o=this.canvas.ownerDocument||F&&document;if(o){var p=a.size,l=o.createElement("canvas"),u=l.getContext("2d"),c=this.computeBBox(a.path);c&&(c.width||c.height)?(l.width=this.canvas.width,l.height=this.canvas.height,u.translate(c.x||0,c.y||0)):(l.width=p[0],l.height=p[1]),this.fillSketch(u,a,i),this.ctx.save(),this.ctx.fillStyle=this.ctx.createPattern(l,"repeat");h=new Path2D(a.path);this.ctx.fill(h),this.ctx.restore()}else console.error("Cannot render path2Dpattern. No defs/document defined.")}}},t.prototype.computeBBox=function(t){if(F)try{var e="http://www.w3.org/2000/svg",i=document.createElementNS(e,"svg");i.setAttribute("width","0"),i.setAttribute("height","0");var r=self.document.createElementNS(e,"path");r.setAttribute("d",t),i.appendChild(r),document.body.appendChild(i);var s=r.getBBox();return document.body.removeChild(i),s}catch(t){}return null},t.prototype.fillSketch=function(t,e,i){var r=i.fillWeight;r<0&&(r=i.strokeWidth/2),t.save(),t.strokeStyle=i.fill||"",t.lineWidth=r,this._drawToContext(t,e),t.restore()},t.prototype._drawToContext=function(t,e){t.beginPath();for(var i=0,r=e.ops;i<r.length;i++){var s=r[i],n=s.data;switch(s.op){case"move":t.moveTo(n[0],n[1]);break;case"bcurveTo":t.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5]);break;case"qcurveTo":t.quadraticCurveTo(n[0],n[1],n[2],n[3]);break;case"lineTo":t.lineTo(n[0],n[1])}}"fillPath"===e.type?t.fill():t.stroke()},t}()),Z="undefined"!=typeof document,$=function(t){function i(e,i){var r=t.call(this,e)||this;return r.gen=new V(i||null,r.svg),r}return e(i,t),Object.defineProperty(i.prototype,"generator",{get:function(){return this.gen},enumerable:!0,configurable:!0}),i.prototype.getDefaultOptions=function(){return this.gen.defaultOptions},i.prototype.opsToPath=function(t){return this.gen.opsToPath(t)},i.prototype.line=function(t,e,i,r,s){var n=this.gen.line(t,e,i,r,s);return this.draw(n)},i.prototype.rectangle=function(t,e,i,r,s){var n=this.gen.rectangle(t,e,i,r,s);return this.draw(n)},i.prototype.ellipse=function(t,e,i,r,s){var n=this.gen.ellipse(t,e,i,r,s);return this.draw(n)},i.prototype.circle=function(t,e,i,r){var s=this.gen.circle(t,e,i,r);return this.draw(s)},i.prototype.linearPath=function(t,e){var i=this.gen.linearPath(t,e);return this.draw(i)},i.prototype.polygon=function(t,e){var i=this.gen.polygon(t,e);return this.draw(i)},i.prototype.arc=function(t,e,i,r,s,n,a,h){void 0===a&&(a=!1);var o=this.gen.arc(t,e,i,r,s,n,a,h);return this.draw(o)},i.prototype.curve=function(t,e){var i=this.gen.curve(t,e);return this.draw(i)},i.prototype.path=function(t,e){var i=this.gen.path(t,e);return this.draw(i)},i}(function(){function t(t){this.svg=t}return Object.defineProperty(t.prototype,"defs",{get:function(){var t=this.svg.ownerDocument||Z&&document;if(t&&!this._defs){var e=t.createElementNS("http://www.w3.org/2000/svg","defs");this.svg.firstChild?this.svg.insertBefore(e,this.svg.firstChild):this.svg.appendChild(e),this._defs=e}return this._defs||null},enumerable:!0,configurable:!0}),t.prototype.draw=function(t){for(var e=t.sets||[],i=t.options||this.getDefaultOptions(),r=this.svg.ownerDocument||window.document,s=r.createElementNS("http://www.w3.org/2000/svg","g"),n=0,a=e;n<a.length;n++){var h=a[n],o=null;switch(h.type){case"path":(o=r.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",this.opsToPath(h)),o.style.stroke=i.stroke,o.style.strokeWidth=i.strokeWidth+"",o.style.fill="none";break;case"fillPath":(o=r.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",this.opsToPath(h)),o.style.stroke="none",o.style.strokeWidth="0",o.style.fill=i.fill||null;break;case"fillSketch":o=this.fillSketch(r,h,i);break;case"path2Dfill":(o=r.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",h.path||""),o.style.stroke="none",o.style.strokeWidth="0",o.style.fill=i.fill||null;break;case"path2Dpattern":if(this.defs){var p=h.size,l=r.createElementNS("http://www.w3.org/2000/svg","pattern"),u="rough-"+Math.floor(Math.random()*(Number.MAX_SAFE_INTEGER||999999));l.setAttribute("id",u),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("width","1"),l.setAttribute("height","1"),l.setAttribute("height","1"),l.setAttribute("viewBox","0 0 "+Math.round(p[0])+" "+Math.round(p[1])),l.setAttribute("patternUnits","objectBoundingBox");var c=this.fillSketch(r,h,i);l.appendChild(c),this.defs.appendChild(l),(o=r.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",h.path||""),o.style.stroke="none",o.style.strokeWidth="0",o.style.fill="url(#"+u+")"}else console.error("Cannot render path2Dpattern. No defs/document defined.")}o&&s.appendChild(o)}return s},t.prototype.fillSketch=function(t,e,i){var r=i.fillWeight;r<0&&(r=i.strokeWidth/2);var s=t.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",this.opsToPath(e)),s.style.stroke=i.fill||null,s.style.strokeWidth=r+"",s.style.fill="none",s},t}());return{canvas:function(t,e){return new Q(t,e)},svg:function(t,e){return new $(t,e)},generator:function(t,e){return new V(t,e)}}});
