var rough=function(){"use strict";var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};function e(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}function r(t,e,r,i){return new(r||(r=Promise))(function(n,s){function a(t){try{h(i.next(t))}catch(t){s(t)}}function o(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){t.done?n(t.value):new r(function(e){e(t.value)}).then(a,o)}h((i=i.apply(t,e||[])).next())})}function i(t,e){var r,i,n,s,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&s[0]?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){a.label=s[1];break}if(6===s[0]&&a.label<n[1]){a.label=n[1],n=s;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(s);break}n[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],i=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}}var n="undefined"!=typeof self,s=function(){function t(t,e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1},this.config=t||{},this.surface=e,this.config.options&&(this.defaultOptions=this._options(this.config.options))}return t.prototype._options=function(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions},t.prototype._drawable=function(t,e,r){return{shape:t,sets:e||[],options:r||this.defaultOptions}},t.prototype.getCanvasSize=function(){var t=function(t){return t&&"object"==typeof t&&t.baseVal&&t.baseVal.value?t.baseVal.value:t||100};return this.surface?[t(this.surface.width),t(this.surface.height)]:[100,100]},t.prototype.computePolygonSize=function(t){if(t.length){for(var e=t[0][0],r=t[0][0],i=t[0][1],n=t[0][1],s=1;s<t.length;s++)e=Math.min(e,t[s][0]),r=Math.max(r,t[s][0]),i=Math.min(i,t[s][1]),n=Math.max(n,t[s][1]);return[r-e,n-i]}return[0,0]},t.prototype.polygonPath=function(t){var e="";if(t.length){e="M"+t[0][0]+","+t[0][1];for(var r=1;r<t.length;r++)e=e+" L"+t[r][0]+","+t[r][1]}return e},t.prototype.computePathSize=function(t){var e=[0,0];if(n&&self.document)try{var r="http://www.w3.org/2000/svg",i=self.document.createElementNS(r,"svg");i.setAttribute("width","0"),i.setAttribute("height","0");var s=self.document.createElementNS(r,"path");s.setAttribute("d",t),i.appendChild(s),self.document.body.appendChild(i);var a=s.getBBox();a&&(e[0]=a.width||0,e[1]=a.height||0),self.document.body.removeChild(i)}catch(t){}var o=this.getCanvasSize();return e[0]*e[1]||(e=o),e},t.prototype.toPaths=function(t){for(var e=t.sets||[],r=t.options||this.defaultOptions,i=[],n=0,s=e;n<s.length;n++){var a=s[n],o=null;switch(a.type){case"path":o={d:this.opsToPath(a),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:"none"};break;case"fillPath":o={d:this.opsToPath(a),stroke:"none",strokeWidth:0,fill:r.fill||"none"};break;case"fillSketch":o=this.fillSketch(a,r);break;case"path2Dfill":o={d:a.path||"",stroke:"none",strokeWidth:0,fill:r.fill||"none"};break;case"path2Dpattern":var h=a.size,c={x:0,y:0,width:1,height:1,viewBox:"0 0 "+Math.round(h[0])+" "+Math.round(h[1]),patternUnits:"objectBoundingBox",path:this.fillSketch(a,r)};o={d:a.path,stroke:"none",strokeWidth:0,pattern:c}}o&&i.push(o)}return i},t.prototype.fillSketch=function(t,e){var r=e.fillWeight;return r<0&&(r=e.strokeWidth/2),{d:this.opsToPath(t),stroke:e.fill||"none",strokeWidth:r,fill:"none"}},t.prototype.opsToPath=function(t){for(var e="",r=0,i=t.ops;r<i.length;r++){var n=i[r],s=n.data;switch(n.op){case"move":e+="M"+s[0]+" "+s[1]+" ";break;case"bcurveTo":e+="C"+s[0]+" "+s[1]+", "+s[2]+" "+s[3]+", "+s[4]+" "+s[5]+" ";break;case"qcurveTo":e+="Q"+s[0]+" "+s[1]+", "+s[2]+" "+s[3]+" ";break;case"lineTo":e+="L"+s[0]+" "+s[1]+" "}}return e.trim()},t}();function a(t,e){return e=e||[],new Proxy(function(){},{get(r,i,n){if("then"===i){if(0===e.length)return{then:()=>n};const r=t.remote({type:"GET",path:e});return r.then.bind(r)}return a(t,e.concat(i))},set:(r,i,n)=>t.remote({type:"SET",path:e.concat(i),value:n}),apply:(r,i,n)=>t.remote({type:"APPLY",path:e,args:n}),construct:(e,r)=>t.remote({type:"CONSTRUCT",args:r})})}class o{constructor(t,e){this.w=t,this.uid=e||`${Date.now()}-${h()}`,this.c=0,this.cbs={},t.addEventListener("message",e=>{if(this.w.oURL)try{URL.revokeObjectURL(this.w.oURL)}catch(t){}finally{delete this.w.oURL}let r=e.data&&e.data.id,i=r&&this.cbs[r];i&&(delete this.cbs[r],e.data.error?i[1](new Error(e.data.error)):i[0](e.data.targetId?a(new o(t,e.data.targetId)):e.data.value))})}remote(t){const e=t.args||[],r=`${this.uid}-${++this.c}`;return new Promise((i,n)=>{this.cbs[r]=[i,n],this.w.postMessage(Object.assign({},t,{id:r,args:e,target:this.uid}))})}}function h(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)}function c(t){const e=t,r={};self.addEventListener("message",async t=>{let i=t.data||{};i.path=i.path||[];let n=i.target&&r[i.target]||e;const s=t=>t.reduce((t,e)=>t?t[e]:t,n),a=i&&i.id;if(a&&i.type){const t={id:a},e=s(i.path),n=s(i.path.slice(0,-1));switch(i.type){case"GET":t.value=e;break;case"SET":let s=i.path.length&&i.path[i.path.length-1];s&&(n[s]=i.value),t.value=!!s;break;case"APPLY":try{t.value=await e.apply(n,i.args||[])}catch(e){t.error=e.toString()}break;case"CONSTRUCT":try{t.value=new e(...i.args),t.targetId=(t=>{const e=`${Date.now()}-${h()}`;return r[e]=t,e})(t.value)}catch(e){t.error=e.toString()}}self.postMessage(t)}})}function l(t,e){return t.type===e}var u={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:4,t:2,V:1,v:1,Z:0,z:0},p=function(){function t(t){this.COMMAND=0,this.NUMBER=1,this.EOD=2,this.segments=[],this.parseData(t),this.processPoints()}return t.prototype.tokenize=function(t){for(var e=new Array;""!==t;)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]={type:this.COMMAND,text:RegExp.$1},t=t.substr(RegExp.$1.length);else{if(!t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return console.error("Unrecognized segment command: "+t),[];e[e.length]={type:this.NUMBER,text:""+parseFloat(RegExp.$1)},t=t.substr(RegExp.$1.length)}return e[e.length]={type:this.EOD,text:""},e},t.prototype.parseData=function(t){var e=this.tokenize(t),r=0,i=e[r],n="BOD";for(this.segments=new Array;!l(i,this.EOD);){var s=void 0,a=new Array;if("BOD"===n){if("M"!==i.text&&"m"!==i.text)return void this.parseData("M0,0"+t);r++,s=u[i.text],n=i.text}else l(i,this.NUMBER)?s=u[n]:(r++,s=u[i.text],n=i.text);if(r+s<e.length){for(var o=r;o<r+s;o++){var h=e[o];if(!l(h,this.NUMBER))return void console.error("Parameter type is not a number: "+n+","+h.text);a[a.length]=+h.text}if("number"!=typeof u[n])return void console.error("Unsupported segment type: "+n);var c={key:n,data:a};this.segments.push(c),i=e[r+=s],"M"===n&&(n="L"),"m"===n&&(n="l")}else console.error("Path data ended before all parameters were found")}},Object.defineProperty(t.prototype,"closed",{get:function(){if(void 0===this._closed){this._closed=!1;for(var t=0,e=this.segments;t<e.length;t++){"z"===e[t].key.toLowerCase()&&(this._closed=!0)}}return this._closed},enumerable:!0,configurable:!0}),t.prototype.processPoints=function(){for(var t=null,e=[0,0],r=0;r<this.segments.length;r++){var i=this.segments[r];switch(i.key){case"M":case"L":case"T":i.point=[i.data[0],i.data[1]];break;case"m":case"l":case"t":i.point=[i.data[0]+e[0],i.data[1]+e[1]];break;case"H":i.point=[i.data[0],e[1]];break;case"h":i.point=[i.data[0]+e[0],e[1]];break;case"V":i.point=[e[0],i.data[0]];break;case"v":i.point=[e[0],i.data[0]+e[1]];break;case"z":case"Z":t&&(i.point=[t[0],t[1]]);break;case"C":i.point=[i.data[4],i.data[5]];break;case"c":i.point=[i.data[4]+e[0],i.data[5]+e[1]];break;case"S":i.point=[i.data[2],i.data[3]];break;case"s":i.point=[i.data[2]+e[0],i.data[3]+e[1]];break;case"Q":i.point=[i.data[2],i.data[3]];break;case"q":i.point=[i.data[2]+e[0],i.data[3]+e[1]];break;case"A":i.point=[i.data[5],i.data[6]];break;case"a":i.point=[i.data[5]+e[0],i.data[6]+e[1]]}"m"!==i.key&&"M"!==i.key||(t=null),i.point&&(e=i.point,t||(t=i.point)),"z"!==i.key&&"Z"!==i.key||(t=null)}},t}(),f=function(){function t(t){this._position=[0,0],this._first=null,this.bezierReflectionPoint=null,this.quadReflectionPoint=null,this.parsed=new p(t)}return Object.defineProperty(t.prototype,"segments",{get:function(){return this.parsed.segments},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"closed",{get:function(){return this.parsed.closed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"linearPoints",{get:function(){if(!this._linearPoints){for(var t=[],e=[],r=0,i=this.parsed.segments;r<i.length;r++){var n=i[r],s=n.key.toLowerCase();("m"!==s&&"z"!==s||(e.length&&(t.push(e),e=[]),"z"!==s))&&(n.point&&e.push(n.point))}e.length&&(t.push(e),e=[]),this._linearPoints=t}return this._linearPoints},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"first",{get:function(){return this._first},set:function(t){this._first=t},enumerable:!0,configurable:!0}),t.prototype.setPosition=function(t,e){this._position=[t,e],this._first||(this._first=[t,e])},Object.defineProperty(t.prototype,"position",{get:function(){return this._position},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._position[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._position[1]},enumerable:!0,configurable:!0}),t}(),d=function(){function t(t,e,r,i,n,s){if(this._segIndex=0,this._numSegs=0,this._rx=0,this._ry=0,this._sinPhi=0,this._cosPhi=0,this._C=[0,0],this._theta=0,this._delta=0,this._T=0,this._from=t,t[0]!==e[0]||t[1]!==e[1]){var a=Math.PI/180;this._rx=Math.abs(r[0]),this._ry=Math.abs(r[1]),this._sinPhi=Math.sin(i*a),this._cosPhi=Math.cos(i*a);var o=this._cosPhi*(t[0]-e[0])/2+this._sinPhi*(t[1]-e[1])/2,h=-this._sinPhi*(t[0]-e[0])/2+this._cosPhi*(t[1]-e[1])/2,c=0,l=this._rx*this._rx*this._ry*this._ry-this._rx*this._rx*h*h-this._ry*this._ry*o*o;if(l<0){var u=Math.sqrt(1-l/(this._rx*this._rx*this._ry*this._ry));this._rx=this._rx*u,this._ry=this._ry*u,c=0}else c=(n===s?-1:1)*Math.sqrt(l/(this._rx*this._rx*h*h+this._ry*this._ry*o*o));var p=c*this._rx*h/this._ry,f=-c*this._ry*o/this._rx;this._C=[0,0],this._C[0]=this._cosPhi*p-this._sinPhi*f+(t[0]+e[0])/2,this._C[1]=this._sinPhi*p+this._cosPhi*f+(t[1]+e[1])/2,this._theta=this.calculateVectorAngle(1,0,(o-p)/this._rx,(h-f)/this._ry);var d=this.calculateVectorAngle((o-p)/this._rx,(h-f)/this._ry,(-o-p)/this._rx,(-h-f)/this._ry);!s&&d>0?d-=2*Math.PI:s&&d<0&&(d+=2*Math.PI),this._numSegs=Math.ceil(Math.abs(d/(Math.PI/2))),this._delta=d/this._numSegs,this._T=8/3*Math.sin(this._delta/4)*Math.sin(this._delta/4)/Math.sin(this._delta/2)}}return t.prototype.getNextSegment=function(){if(this._segIndex===this._numSegs)return null;var t=Math.cos(this._theta),e=Math.sin(this._theta),r=this._theta+this._delta,i=Math.cos(r),n=Math.sin(r),s=[this._cosPhi*this._rx*i-this._sinPhi*this._ry*n+this._C[0],this._sinPhi*this._rx*i+this._cosPhi*this._ry*n+this._C[1]],a=[this._from[0]+this._T*(-this._cosPhi*this._rx*e-this._sinPhi*this._ry*t),this._from[1]+this._T*(-this._sinPhi*this._rx*e+this._cosPhi*this._ry*t)],o=[s[0]+this._T*(this._cosPhi*this._rx*n+this._sinPhi*this._ry*i),s[1]+this._T*(this._sinPhi*this._rx*n-this._cosPhi*this._ry*i)];return this._theta=r,this._from=[s[0],s[1]],this._segIndex++,{cp1:a,cp2:o,to:s}},t.prototype.calculateVectorAngle=function(t,e,r,i){var n=Math.atan2(e,t),s=Math.atan2(i,r);return s>=n?s-n:2*Math.PI-(n-s)},t}(),y=function(){function t(t,e){this.sets=t,this.closed=e}return t.prototype.fit=function(t){for(var e=[],r=0,i=this.sets;r<i.length;r++){var n=(c=i[r]).length,s=Math.floor(t*n);if(s<5){if(n<=5)continue;s=5}e.push(this.reduce(c,s))}for(var a="",o=0,h=e;o<h.length;o++){for(var c=h[o],l=0;l<c.length;l++){var u=c[l];a+=0===l?"M"+u[0]+","+u[1]:"L"+u[0]+","+u[1]}this.closed&&(a+="z ")}return a},t.prototype.distance=function(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))},t.prototype.reduce=function(t,e){if(t.length<=e)return t;for(var r=t.slice(0);r.length>e;){for(var i=[],n=-1,s=-1,a=1;a<r.length-1;a++){var o=this.distance(r[a-1],r[a]),h=this.distance(r[a],r[a+1]),c=this.distance(r[a-1],r[a+1]),l=(o+h+c)/2,u=Math.sqrt(l*(l-o)*(l-h)*(l-c));i.push(u),(n<0||u<n)&&(n=u,s=a)}if(!(s>0))break;r.splice(s,1)}return r},t}(),v=function(){function t(t,e){this.xi=Number.MAX_VALUE,this.yi=Number.MAX_VALUE,this.px1=t[0],this.py1=t[1],this.px2=e[0],this.py2=e[1],this.a=this.py2-this.py1,this.b=this.px1-this.px2,this.c=this.px2*this.py1-this.px1*this.py2,this._undefined=0===this.a&&0===this.b&&0===this.c}return t.prototype.isUndefined=function(){return this._undefined},t.prototype.intersects=function(t){if(this.isUndefined()||t.isUndefined())return!1;var e=Number.MAX_VALUE,r=Number.MAX_VALUE,i=0,n=0,s=this.a,a=this.b,o=this.c;return Math.abs(a)>1e-5&&(e=-s/a,i=-o/a),Math.abs(t.b)>1e-5&&(r=-t.a/t.b,n=-t.c/t.b),e===Number.MAX_VALUE?r===Number.MAX_VALUE?-o/s==-t.c/t.a&&(this.py1>=Math.min(t.py1,t.py2)&&this.py1<=Math.max(t.py1,t.py2)?(this.xi=this.px1,this.yi=this.py1,!0):this.py2>=Math.min(t.py1,t.py2)&&this.py2<=Math.max(t.py1,t.py2)&&(this.xi=this.px2,this.yi=this.py2,!0)):(this.xi=this.px1,this.yi=r*this.xi+n,!((this.py1-this.yi)*(this.yi-this.py2)<-1e-5||(t.py1-this.yi)*(this.yi-t.py2)<-1e-5)&&(!(Math.abs(t.a)<1e-5)||!((t.px1-this.xi)*(this.xi-t.px2)<-1e-5))):r===Number.MAX_VALUE?(this.xi=t.px1,this.yi=e*this.xi+i,!((t.py1-this.yi)*(this.yi-t.py2)<-1e-5||(this.py1-this.yi)*(this.yi-this.py2)<-1e-5)&&(!(Math.abs(s)<1e-5)||!((this.px1-this.xi)*(this.xi-this.px2)<-1e-5))):e===r?i===n&&(this.px1>=Math.min(t.px1,t.px2)&&this.px1<=Math.max(t.py1,t.py2)?(this.xi=this.px1,this.yi=this.py1,!0):this.px2>=Math.min(t.px1,t.px2)&&this.px2<=Math.max(t.px1,t.px2)&&(this.xi=this.px2,this.yi=this.py2,!0)):(this.xi=(n-i)/(e-r),this.yi=e*this.xi+i,!((this.px1-this.xi)*(this.xi-this.px2)<-1e-5||(t.px1-this.xi)*(this.xi-t.px2)<-1e-5))},t}();var g=function(){function t(t,e,r,i,n,s,a,o){this.deltaX=0,this.hGap=0,this.top=t,this.bottom=e,this.left=r,this.right=i,this.gap=n,this.sinAngle=s,this.tanAngle=o,Math.abs(s)<1e-4?this.pos=r+n:Math.abs(s)>.9999?this.pos=t+n:(this.deltaX=(e-t)*Math.abs(o),this.pos=r-Math.abs(this.deltaX),this.hGap=Math.abs(n/a),this.sLeft=new v([r,e],[r,t]),this.sRight=new v([i,e],[i,t]))}return t.prototype.nextLine=function(){if(Math.abs(this.sinAngle)<1e-4){if(this.pos<this.right){var t=[this.pos,this.top,this.pos,this.bottom];return this.pos+=this.gap,t}}else if(Math.abs(this.sinAngle)>.9999){if(this.pos<this.bottom){t=[this.left,this.pos,this.right,this.pos];return this.pos+=this.gap,t}}else{var e=this.pos-this.deltaX/2,r=this.pos+this.deltaX/2,i=this.bottom,n=this.top;if(this.pos<this.right+this.deltaX){for(;e<this.left&&r<this.left||e>this.right&&r>this.right;)if(this.pos+=this.hGap,e=this.pos-this.deltaX/2,r=this.pos+this.deltaX/2,this.pos>this.right+this.deltaX)return null;var s=new v([e,i],[r,n]);this.sLeft&&s.intersects(this.sLeft)&&(e=s.xi,i=s.yi),this.sRight&&s.intersects(this.sRight)&&(r=s.xi,n=s.yi),this.tanAngle>0&&(e=this.right-(e-this.left),r=this.right-(r-this.left));t=[e,i,r,n];return this.pos+=this.hGap,t}}return null},t}();function b(t){var e=t[0],r=t[1];return Math.sqrt(Math.pow(e[0]-r[0],2)+Math.pow(e[1]-r[1],2))}function m(t,e){for(var r=[],i=new v([t[0],t[1]],[t[2],t[3]]),n=0;n<e.length;n++){var s=new v(e[n],e[(n+1)%e.length]);i.intersects(s)&&r.push([i.xi,i.yi])}return r}function M(t,e,r,i,n,s,a){return[-r*s-i*n+r+s*t+n*e,a*(r*n-i*s)+i+-a*n*t+a*s*e]}function w(t,e){var r=[];if(t&&t.length){for(var i=t[0][0],n=t[0][0],s=t[0][1],a=t[0][1],o=1;o<t.length;o++)i=Math.min(i,t[o][0]),n=Math.max(n,t[o][0]),s=Math.min(s,t[o][1]),a=Math.max(a,t[o][1]);var h=e.hachureAngle,c=e.hachureGap;c<0&&(c=4*e.strokeWidth),c=Math.max(c,.1);for(var l=h%180*(Math.PI/180),u=Math.cos(l),p=Math.sin(l),f=Math.tan(l),d=new g(s-1,a+1,i-1,n+1,c,p,u,f),y=void 0;null!=(y=d.nextLine());){var v=m(y,t);for(o=0;o<v.length;o++)if(o<v.length-1){var b=v[o],M=v[o+1];r.push([b,M])}}}return r}function _(t,e,r,i,n,s){var a=[],o=Math.abs(i/2),h=Math.abs(n/2);o+=t.randOffset(.05*o,s),h+=t.randOffset(.05*h,s);var c=s.hachureAngle,l=s.hachureGap;l<=0&&(l=4*s.strokeWidth);var u=s.fillWeight;u<0&&(u=s.strokeWidth/2);for(var p=c%180*(Math.PI/180),f=Math.tan(p),d=h/o,y=Math.sqrt(d*f*d*f+1),v=d*f/y,g=1/y,b=l/(o*h/Math.sqrt(h*g*(h*g)+o*v*(o*v))/o),m=Math.sqrt(o*o-(e-o+b)*(e-o+b)),w=e-o+b;w<e+o;w+=b){var _=M(w,r-(m=Math.sqrt(o*o-(e-w)*(e-w))),e,r,v,g,d),x=M(w,r+m,e,r,v,g,d);a.push([_,x])}return a}var x=function(){function t(t){this.helper=t}return t.prototype.fillPolygon=function(t,e){return this._fillPolygon(t,e)},t.prototype.fillEllipse=function(t,e,r,i,n){return this._fillEllipse(t,e,r,i,n)},t.prototype.fillArc=function(t,e,r,i,n,s,a){return null},t.prototype._fillPolygon=function(t,e,r){void 0===r&&(r=!1);var i=w(t,e);return{type:"fillSketch",ops:this.renderLines(i,e,r)}},t.prototype._fillEllipse=function(t,e,r,i,n,s){void 0===s&&(s=!1);var a=_(this.helper,t,e,r,i,n);return{type:"fillSketch",ops:this.renderLines(a,n,s)}},t.prototype.renderLines=function(t,e,r){for(var i=[],n=null,s=0,a=t;s<a.length;s++){var o=a[s];i=i.concat(this.helper.doubleLineOps(o[0][0],o[0][1],o[1][0],o[1][1],e)),r&&n&&(i=i.concat(this.helper.doubleLineOps(n[0],n[1],o[0][0],o[0][1],e))),n=o[1]}return i},t}(),P=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.fillPolygon=function(t,e){return this._fillPolygon(t,e,!0)},r.prototype.fillEllipse=function(t,e,r,i,n){return this._fillEllipse(t,e,r,i,n,!0)},r}(x),k=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.fillPolygon=function(t,e){var r=this._fillPolygon(t,e),i=Object.assign({},e,{hachureAngle:e.hachureAngle+90}),n=this._fillPolygon(t,i);return r.ops=r.ops.concat(n.ops),r},r.prototype.fillEllipse=function(t,e,r,i,n){var s=this._fillEllipse(t,e,r,i,n),a=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),o=this._fillEllipse(t,e,r,i,a);return s.ops=s.ops.concat(o.ops),s},r}(x),S=function(){function t(t){this.helper=t}return t.prototype.fillPolygon=function(t,e){var r=w(t,e=Object.assign({},e,{curveStepCount:4,hachureAngle:0}));return this.dotsOnLines(r,e)},t.prototype.fillEllipse=function(t,e,r,i,n){n=Object.assign({},n,{curveStepCount:4,hachureAngle:0});var s=_(this.helper,t,e,r,i,n);return this.dotsOnLines(s,n)},t.prototype.fillArc=function(t,e,r,i,n,s,a){return null},t.prototype.dotsOnLines=function(t,e){var r=[],i=e.hachureGap;i<0&&(i=4*e.strokeWidth),i=Math.max(i,.1);var n=e.fillWeight;n<0&&(n=e.strokeWidth/2);for(var s=0,a=t;s<a.length;s++)for(var o=a[s],h=b(o)/i,c=Math.ceil(h)-1,l=Math.atan((o[1][1]-o[0][1])/(o[1][0]-o[0][0])),u=0;u<c;u++){var p=i*(u+1),f=p*Math.sin(l),d=p*Math.cos(l),y=[o[0][0]-d,o[0][1]+f],v=this.helper.randOffsetWithRange(y[0]-i/4,y[0]+i/4,e),g=this.helper.randOffsetWithRange(y[1]-i/4,y[1]+i/4,e),m=this.helper.ellipse(v,g,n,n,e);r=r.concat(m.ops)}return{type:"fillSketch",ops:r}},t}(),O=function(){function t(t){this.helper=t}return t.prototype.fillPolygon=function(t,e){var r=[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER],i=[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER];t.forEach(function(t){r[0]=Math.min(r[0],t[0]),r[1]=Math.max(r[1],t[0]),i[0]=Math.min(i[0],t[1]),i[1]=Math.max(i[1],t[1])});var n=function(t){for(var e=0,r=0,i=0,n=0;n<t.length;n++){var s=t[n],a=n===t.length-1?t[0]:t[n+1];e+=s[0]*a[1]-a[0]*s[1]}for(e/=2,n=0;n<t.length;n++)s=t[n],a=n===t.length-1?t[0]:t[n+1],r+=(s[0]+a[0])*(s[0]*a[1]-a[0]*s[1]),i+=(s[1]+a[1])*(s[0]*a[1]-a[0]*s[1]);return[r/(6*e),i/(6*e)]}(t),s=Math.max(Math.sqrt(Math.pow(n[0]-r[0],2)+Math.pow(n[1]-i[0],2)),Math.sqrt(Math.pow(n[0]-r[1],2)+Math.pow(n[1]-i[1],2))),a=e.hachureGap>0?e.hachureGap:4*e.strokeWidth,o=[];if(t.length>2)for(var h=0;h<t.length;h++)h===t.length-1?o.push([t[h],t[0]]):o.push([t[h],t[h+1]]);var c=[],l=Math.max(1,Math.PI*s/a),u=function(t){var e=t*Math.PI/l,a=[n,[n[0]+s*Math.cos(e),n[1]+s*Math.sin(e)]];o.forEach(function(t){var e,n,s,o,h,l,u,p,f,d=(n=a,s=(e=t)[1][1]-e[0][1],o=e[0][0]-e[1][0],h=s*e[0][0]+o*e[0][1],l=n[1][1]-n[0][1],u=n[0][0]-n[1][0],p=l*n[0][0]+u*n[0][1],(f=s*u-l*o)?[Math.round((u*h-o*p)/f),Math.round((s*p-l*h)/f)]:null);d&&d[0]>=r[0]&&d[0]<=r[1]&&d[1]>=i[0]&&d[1]<=i[1]&&c.push(d)})};for(h=0;h<l;h++)u(h);c=this.removeDuplocatePoints(c);var p=this.createLinesFromCenter(n,c);return{type:"fillSketch",ops:this.drawLines(p,e)}},t.prototype.fillEllipse=function(t,e,r,i,n){return this.fillArcSegment(t,e,r,i,0,2*Math.PI,n)},t.prototype.fillArc=function(t,e,r,i,n,s,a){return this.fillArcSegment(t,e,r,i,n,s,a)},t.prototype.fillArcSegment=function(t,e,r,i,n,s,a){var o=[t,e],h=r/2,c=i/2,l=Math.max(r/2,i/2),u=a.hachureGap;u<0&&(u=4*a.strokeWidth);for(var p=Math.max(1,Math.abs(s-n)*l/u),f=[],d=0;d<p;d++){var y=d*((s-n)/p)+n,v=l*Math.cos(y),g=l*Math.sin(y),b=Math.sqrt(h*h*g*g+c*c*v*v),m=h*c*v/b,M=h*c*g/b;f.push([o[0]+m,o[1]+M])}f=this.removeDuplocatePoints(f);var w=this.createLinesFromCenter(o,f);return{type:"fillSketch",ops:this.drawLines(w,a)}},t.prototype.drawLines=function(t,e){var r=this,i=[];return t.forEach(function(t){var n=t[0],s=t[1];i=i.concat(r.helper.doubleLineOps(n[0],n[1],s[0],s[1],e))}),i},t.prototype.createLinesFromCenter=function(t,e){return e.map(function(e){return[t,e]})},t.prototype.removeDuplocatePoints=function(t){var e=new Set;return t.filter(function(t){var r=t.join(",");return!e.has(r)&&(e.add(r),!0)})},t}(),A=function(){function t(t){this.helper=t}return t.prototype.fillPolygon=function(t,e){var r=w(t,e);return{type:"fillSketch",ops:this.dashedLine(r,e)}},t.prototype.fillEllipse=function(t,e,r,i,n){var s=_(this.helper,t,e,r,i,n);return{type:"fillSketch",ops:this.dashedLine(s,n)}},t.prototype.fillArc=function(t,e,r,i,n,s,a){return null},t.prototype.dashedLine=function(t,e){var r=this,i=e.dashOffset<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashOffset,n=e.dashGap<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashGap,s=[];return t.forEach(function(t){var a=b(t),o=Math.floor(a/(i+n)),h=(a+n-o*(i+n))/2,c=t[0],l=t[1];c[0]>l[0]&&(c=t[1],l=t[0]);for(var u=Math.atan((l[1]-c[1])/(l[0]-c[0])),p=0;p<o;p++){var f=p*(i+n),d=f+i,y=[c[0]+f*Math.cos(u)+h*Math.cos(u),c[1]+f*Math.sin(u)+h*Math.sin(u)],v=[c[0]+d*Math.cos(u)+h*Math.cos(u),c[1]+d*Math.sin(u)+h*Math.sin(u)];s=s.concat(r.helper.doubleLineOps(y[0],y[1],v[0],v[1],e))}}),s},t}(),E=function(){function t(t){this.helper=t}return t.prototype.fillPolygon=function(t,e){var r=e.hachureGap<0?4*e.strokeWidth:e.hachureGap,i=e.zigzagOffset<0?r:e.zigzagOffset,n=w(t,e=Object.assign({},e,{hachureGap:r+i}));return{type:"fillSketch",ops:this.zigzagLines(n,i,e)}},t.prototype.fillEllipse=function(t,e,r,i,n){var s=n.hachureGap<0?4*n.strokeWidth:n.hachureGap,a=n.zigzagOffset<0?s:n.zigzagOffset;n=Object.assign({},n,{hachureGap:s+a});var o=_(this.helper,t,e,r,i,n);return{type:"fillSketch",ops:this.zigzagLines(o,a,n)}},t.prototype.fillArc=function(t,e,r,i,n,s,a){return null},t.prototype.zigzagLines=function(t,e,r){var i=this,n=[];return t.forEach(function(t){var s=b(t),a=Math.round(s/(2*e)),o=t[0],h=t[1];o[0]>h[0]&&(o=t[1],h=t[0]);for(var c=Math.atan((h[1]-o[1])/(h[0]-o[0])),l=0;l<a;l++){var u=2*l*e,p=2*(l+1)*e,f=Math.sqrt(2*Math.pow(e,2)),d=[o[0]+u*Math.cos(c),o[1]+u*Math.sin(c)],y=[o[0]+p*Math.cos(c),o[1]+p*Math.sin(c)],v=[d[0]+f*Math.cos(c+Math.PI/4),d[1]+f*Math.sin(c+Math.PI/4)];n=(n=n.concat(i.helper.doubleLineOps(d[0],d[1],v[0],v[1],r))).concat(i.helper.doubleLineOps(v[0],v[1],y[0],y[1],r))}}),n},t}(),T={};function L(t,e){var r=t.fillStyle||"hachure";if(!T[r])switch(r){case"zigzag":T[r]||(T[r]=new P(e));break;case"cross-hatch":T[r]||(T[r]=new k(e));break;case"dots":T[r]||(T[r]=new S(e));break;case"starburst":T[r]||(T[r]=new O(e));break;case"dashed":T[r]||(T[r]=new A(e));break;case"zigzag-line":T[r]||(T[r]=new E(e));break;case"hachure":default:T[r="hachure"]||(T[r]=new x(e))}return T[r]}var C={randOffset:D,randOffsetWithRange:G,ellipse:W,doubleLineOps:q};function R(t,e,r,i,n){return{type:"path",ops:B(t,e,r,i,n)}}function z(t,e,r){var i=(t||[]).length;if(i>2){for(var n=[],s=0;s<i-1;s++)n=n.concat(B(t[s][0],t[s][1],t[s+1][0],t[s+1][1],r));return e&&(n=n.concat(B(t[i-1][0],t[i-1][1],t[0][0],t[0][1],r))),{type:"path",ops:n}}return 2===i?R(t[0][0],t[0][1],t[1][0],t[1][1],r):{type:"path",ops:[]}}function N(t,e){return z(t,!0,e)}function W(t,e,r,i,n){var s=2*Math.PI/n.curveStepCount,a=Math.abs(r/2),o=Math.abs(i/2),h=$(s,t,e,a+=j(.05*a,n),o+=j(.05*o,n),1,s*U(.1,U(.4,1,n),n),n),c=$(s,t,e,a,o,1.5,0,n);return{type:"path",ops:h.concat(c)}}function I(t,e){return L(e,C).fillPolygon(t,e)}function D(t,e){return j(t,e)}function G(t,e,r){return U(t,e,r)}function q(t,e,r,i,n){return B(t,e,r,i,n)}function U(t,e,r){return r.roughness*(Math.random()*(e-t)+t)}function j(t,e){return U(-t,t,e)}function B(t,e,r,i,n){var s=F(t,e,r,i,n,!0,!1),a=F(t,e,r,i,n,!0,!0);return s.concat(a)}function F(t,e,r,i,n,s,a){var o=Math.pow(t-r,2)+Math.pow(e-i,2),h=n.maxRandomnessOffset||0;h*h*100>o&&(h=Math.sqrt(o)/10);var c=h/2,l=.2+.2*Math.random(),u=n.bowing*n.maxRandomnessOffset*(i-e)/200,p=n.bowing*n.maxRandomnessOffset*(t-r)/200;u=j(u,n),p=j(p,n);var f=[],d=function(){return j(c,n)},y=function(){return j(h,n)};return s&&(a?f.push({op:"move",data:[t+d(),e+d()]}):f.push({op:"move",data:[t+j(h,n),e+j(h,n)]})),a?f.push({op:"bcurveTo",data:[u+t+(r-t)*l+d(),p+e+(i-e)*l+d(),u+t+2*(r-t)*l+d(),p+e+2*(i-e)*l+d(),r+d(),i+d()]}):f.push({op:"bcurveTo",data:[u+t+(r-t)*l+y(),p+e+(i-e)*l+y(),u+t+2*(r-t)*l+y(),p+e+2*(i-e)*l+y(),r+y(),i+y()]}),f}function X(t,e,r){var i=[];i.push([t[0][0]+j(e,r),t[0][1]+j(e,r)]),i.push([t[0][0]+j(e,r),t[0][1]+j(e,r)]);for(var n=1;n<t.length;n++)i.push([t[n][0]+j(e,r),t[n][1]+j(e,r)]),n===t.length-1&&i.push([t[n][0]+j(e,r),t[n][1]+j(e,r)]);return V(i,null,r)}function V(t,e,r){var i=t.length,n=[];if(i>3){var s=[],a=1-r.curveTightness;n.push({op:"move",data:[t[1][0],t[1][1]]});for(var o=1;o+2<i;o++){var h=t[o];s[0]=[h[0],h[1]],s[1]=[h[0]+(a*t[o+1][0]-a*t[o-1][0])/6,h[1]+(a*t[o+1][1]-a*t[o-1][1])/6],s[2]=[t[o+1][0]+(a*t[o][0]-a*t[o+2][0])/6,t[o+1][1]+(a*t[o][1]-a*t[o+2][1])/6],s[3]=[t[o+1][0],t[o+1][1]],n.push({op:"bcurveTo",data:[s[1][0],s[1][1],s[2][0],s[2][1],s[3][0],s[3][1]]})}if(e&&2===e.length){var c=r.maxRandomnessOffset;n.push({op:"lineTo",data:[e[0]+j(c,r),e[1]+j(c,r)]})}}else 3===i?(n.push({op:"move",data:[t[1][0],t[1][1]]}),n.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):2===i&&(n=n.concat(B(t[0][0],t[0][1],t[1][0],t[1][1],r)));return n}function $(t,e,r,i,n,s,a,o){var h=j(.5,o)-Math.PI/2,c=[];c.push([j(s,o)+e+.9*i*Math.cos(h-t),j(s,o)+r+.9*n*Math.sin(h-t)]);for(var l=h;l<2*Math.PI+h-.01;l+=t)c.push([j(s,o)+e+i*Math.cos(l),j(s,o)+r+n*Math.sin(l)]);return c.push([j(s,o)+e+i*Math.cos(h+2*Math.PI+.5*a),j(s,o)+r+n*Math.sin(h+2*Math.PI+.5*a)]),c.push([j(s,o)+e+.98*i*Math.cos(h+a),j(s,o)+r+.98*n*Math.sin(h+a)]),c.push([j(s,o)+e+.9*i*Math.cos(h+.5*a),j(s,o)+r+.9*n*Math.sin(h+.5*a)]),V(c,null,o)}function Q(t,e,r,i,n,s,a,o,h){var c=s+j(.1,h),l=[];l.push([j(o,h)+e+.9*i*Math.cos(c-t),j(o,h)+r+.9*n*Math.sin(c-t)]);for(var u=c;u<=a;u+=t)l.push([j(o,h)+e+i*Math.cos(u),j(o,h)+r+n*Math.sin(u)]);return l.push([e+i*Math.cos(a),r+n*Math.sin(a)]),l.push([e+i*Math.cos(a),r+n*Math.sin(a)]),V(l,null,h)}function Z(t,e,r,i,n,s,a,o){for(var h=[],c=[o.maxRandomnessOffset||1,(o.maxRandomnessOffset||1)+.5],l=[0,0],u=0;u<2;u++)0===u?h.push({op:"move",data:[a.x,a.y]}):h.push({op:"move",data:[a.x+j(c[0],o),a.y+j(c[0],o)]}),l=[n+j(c[u],o),s+j(c[u],o)],h.push({op:"bcurveTo",data:[t+j(c[u],o),e+j(c[u],o),r+j(c[u],o),i+j(c[u],o),l[0],l[1]]});return a.setPosition(l[0],l[1]),h}function H(t,e,r,i){var n=[];switch(e.key){case"M":case"m":var s="m"===e.key;if(e.data.length>=2){var a=+e.data[0],o=+e.data[1];s&&(a+=t.x,o+=t.y);var h=1*(i.maxRandomnessOffset||0);a+=j(h,i),o+=j(h,i),t.setPosition(a,o),n.push({op:"move",data:[a,o]})}break;case"L":case"l":s="l"===e.key;if(e.data.length>=2){a=+e.data[0],o=+e.data[1];s&&(a+=t.x,o+=t.y),n=n.concat(B(t.x,t.y,a,o,i)),t.setPosition(a,o)}break;case"H":case"h":s="h"===e.key;if(e.data.length){a=+e.data[0];s&&(a+=t.x),n=n.concat(B(t.x,t.y,a,t.y,i)),t.setPosition(a,t.y)}break;case"V":case"v":s="v"===e.key;if(e.data.length){o=+e.data[0];s&&(o+=t.y),n=n.concat(B(t.x,t.y,t.x,o,i)),t.setPosition(t.x,o)}break;case"Z":case"z":t.first&&(n=n.concat(B(t.x,t.y,t.first[0],t.first[1],i)),t.setPosition(t.first[0],t.first[1]),t.first=null);break;case"C":case"c":s="c"===e.key;if(e.data.length>=6){var c=+e.data[0],l=+e.data[1],u=+e.data[2],p=+e.data[3];a=+e.data[4],o=+e.data[5];s&&(c+=t.x,u+=t.x,a+=t.x,l+=t.y,p+=t.y,o+=t.y);var f=Z(c,l,u,p,a,o,t,i);n=n.concat(f),t.bezierReflectionPoint=[a+(a-u),o+(o-p)]}break;case"S":case"s":s="s"===e.key;if(e.data.length>=4){u=+e.data[0],p=+e.data[1],a=+e.data[2],o=+e.data[3];s&&(u+=t.x,a+=t.x,p+=t.y,o+=t.y);c=u,l=p;var y=null;"c"!==(m=r?r.key:"")&&"C"!==m&&"s"!==m&&"S"!==m||(y=t.bezierReflectionPoint),y&&(c=y[0],l=y[1]);f=Z(c,l,u,p,a,o,t,i);n=n.concat(f),t.bezierReflectionPoint=[a+(a-u),o+(o-p)]}break;case"Q":case"q":s="q"===e.key;if(e.data.length>=4){c=+e.data[0],l=+e.data[1],a=+e.data[2],o=+e.data[3];s&&(c+=t.x,a+=t.x,l+=t.y,o+=t.y);var v=1*(1+.2*i.roughness),g=1.5*(1+.22*i.roughness);n.push({op:"move",data:[t.x+j(v,i),t.y+j(v,i)]});var b=[a+j(v,i),o+j(v,i)];n.push({op:"qcurveTo",data:[c+j(v,i),l+j(v,i),b[0],b[1]]}),n.push({op:"move",data:[t.x+j(g,i),t.y+j(g,i)]}),b=[a+j(g,i),o+j(g,i)],n.push({op:"qcurveTo",data:[c+j(g,i),l+j(g,i),b[0],b[1]]}),t.setPosition(b[0],b[1]),t.quadReflectionPoint=[a+(a-c),o+(o-l)]}break;case"T":case"t":s="t"===e.key;if(e.data.length>=2){a=+e.data[0],o=+e.data[1];s&&(a+=t.x,o+=t.y);var m;c=a,l=o,y=null;"q"!==(m=r?r.key:"")&&"Q"!==m&&"t"!==m&&"T"!==m||(y=t.quadReflectionPoint),y&&(c=y[0],l=y[1]);v=1*(1+.2*i.roughness),g=1.5*(1+.22*i.roughness);n.push({op:"move",data:[t.x+j(v,i),t.y+j(v,i)]});b=[a+j(v,i),o+j(v,i)];n.push({op:"qcurveTo",data:[c+j(v,i),l+j(v,i),b[0],b[1]]}),n.push({op:"move",data:[t.x+j(g,i),t.y+j(g,i)]}),b=[a+j(g,i),o+j(g,i)],n.push({op:"qcurveTo",data:[c+j(g,i),l+j(g,i),b[0],b[1]]}),t.setPosition(b[0],b[1]),t.quadReflectionPoint=[a+(a-c),o+(o-l)]}break;case"A":case"a":s="a"===e.key;if(e.data.length>=7){var M=+e.data[0],w=+e.data[1],_=+e.data[2],x=+e.data[3],P=+e.data[4];a=+e.data[5],o=+e.data[6];if(s&&(a+=t.x,o+=t.y),a===t.x&&o===t.y)break;if(0===M||0===w)n=n.concat(B(t.x,t.y,a,o,i)),t.setPosition(a,o);else for(var k=0;k<1;k++)for(var S=new d([t.x,t.y],[a,o],[M,w],_,!!x,!!P),O=S.getNextSegment();O;){f=Z(O.cp1[0],O.cp1[1],O.cp2[0],O.cp2[1],O.to[0],O.to[1],t,i);n=n.concat(f),O=S.getNextSegment()}}}return n}var Y=Object.freeze({line:R,linearPath:z,polygon:N,rectangle:function(t,e,r,i,n){return N([[t,e],[t+r,e],[t+r,e+i],[t,e+i]],n)},curve:function(t,e){var r=X(t,1*(1+.2*e.roughness),e),i=X(t,1.5*(1+.22*e.roughness),e);return{type:"path",ops:r.concat(i)}},ellipse:W,arc:function(t,e,r,i,n,s,a,o,h){var c=t,l=e,u=Math.abs(r/2),p=Math.abs(i/2);u+=j(.01*u,h),p+=j(.01*p,h);for(var f=n,d=s;f<0;)f+=2*Math.PI,d+=2*Math.PI;d-f>2*Math.PI&&(f=0,d=2*Math.PI);var y=2*Math.PI/h.curveStepCount,v=Math.min(y/2,(d-f)/2),g=Q(v,c,l,u,p,f,d,1,h),b=Q(v,c,l,u,p,f,d,1.5,h),m=g.concat(b);return a&&(o?m=(m=m.concat(B(c,l,c+u*Math.cos(f),l+p*Math.sin(f),h))).concat(B(c,l,c+u*Math.cos(d),l+p*Math.sin(d),h)):(m.push({op:"lineTo",data:[c,l]}),m.push({op:"lineTo",data:[c+u*Math.cos(f),l+p*Math.sin(f)]}))),{type:"path",ops:m}},svgPath:function(t,e){t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");var r=new f(t);if(e.simplification){var i=new y(r.linearPoints,r.closed).fit(e.simplification);r=new f(i)}for(var n=[],s=r.segments||[],a=0;a<s.length;a++){var o=H(r,s[a],a>0?s[a-1]:null,e);o&&o.length&&(n=n.concat(o))}return{type:"path",ops:n}},solidFillPolygon:function(t,e){var r=[];if(t.length){var i=e.maxRandomnessOffset||0,n=t.length;if(n>2){r.push({op:"move",data:[t[0][0]+j(i,e),t[0][1]+j(i,e)]});for(var s=1;s<n;s++)r.push({op:"lineTo",data:[t[s][0]+j(i,e),t[s][1]+j(i,e)]})}}return{type:"fillPath",ops:r}},patternFillPolygon:I,patternFillEllipse:function(t,e,r,i,n){return L(n,C).fillEllipse(t,e,r,i,n)},patternFillArc:function(t,e,r,i,n,s,a){var o=L(a,C).fillArc(t,e,r,i,n,s,a);if(o)return o;var h=t,c=e,l=Math.abs(r/2),u=Math.abs(i/2);l+=j(.01*l,a),u+=j(.01*u,a);for(var p=n,f=s;p<0;)p+=2*Math.PI,f+=2*Math.PI;f-p>2*Math.PI&&(p=0,f=2*Math.PI);for(var d=(f-p)/a.curveStepCount,y=[],v=p;v<=f;v+=d)y.push([h+l*Math.cos(v),c+u*Math.sin(v)]);return y.push([h+l*Math.cos(f),c+u*Math.sin(f)]),y.push([h,c]),I(y,a)},randOffset:D,randOffsetWithRange:G,doubleLineOps:q}),J=function(t){function n(e,r){var i=t.call(this,e,r)||this;return e&&e.workerURL?i.renderer=function(t){let e,r;if("function"==typeof t){const i=Function.prototype.toString;e=r=URL.createObjectURL(new Blob([`${i.call(h)}\n(${i.call(c)})(${i.call(t)})`]))}else"string"==typeof t&&(e=t,0===t.indexOf("blob:")&&(r=e));if(e){let t=new Worker(e);return r&&(t.oURL=r),a(new o(t))}throw"Workly only supports functions, classes, urls"}(e.workerURL):i.renderer=Y,i}return e(n,t),n.prototype.line=function(t,e,n,s,a){return r(this,void 0,Promise,function(){var r,o,h;return i(this,function(i){switch(i.label){case 0:return r=this._options(a),o=this._drawable,h=["line"],[4,this.renderer.line(t,e,n,s,r)];case 1:return[2,o.apply(this,h.concat([[i.sent()],r]))]}})})},n.prototype.rectangle=function(t,e,n,s,a){return r(this,void 0,Promise,function(){var r,o,h,c,l,u,p,f,d;return i(this,function(i){switch(i.label){case 0:return r=this._options(a),o=[],r.fill?(h=[[t,e],[t+n,e],[t+n,e+s],[t,e+s]],"solid"!==r.fillStyle?[3,2]:(l=(c=o).push,[4,this.renderer.solidFillPolygon(h,r)])):[3,4];case 1:return l.apply(c,[i.sent()]),[3,4];case 2:return p=(u=o).push,[4,this.renderer.patternFillPolygon(h,r)];case 3:p.apply(u,[i.sent()]),i.label=4;case 4:return d=(f=o).push,[4,this.renderer.rectangle(t,e,n,s,r)];case 5:return d.apply(f,[i.sent()]),[2,this._drawable("rectangle",o,r)]}})})},n.prototype.ellipse=function(t,e,n,s,a){return r(this,void 0,Promise,function(){var r,o,h,c,l,u,p;return i(this,function(i){switch(i.label){case 0:return r=this._options(a),o=[],r.fill?"solid"!==r.fillStyle?[3,2]:[4,this.renderer.ellipse(t,e,n,s,r)]:[3,4];case 1:return(h=i.sent()).type="fillPath",o.push(h),[3,4];case 2:return l=(c=o).push,[4,this.renderer.patternFillEllipse(t,e,n,s,r)];case 3:l.apply(c,[i.sent()]),i.label=4;case 4:return p=(u=o).push,[4,this.renderer.ellipse(t,e,n,s,r)];case 5:return p.apply(u,[i.sent()]),[2,this._drawable("ellipse",o,r)]}})})},n.prototype.circle=function(t,e,n,s){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.ellipse(t,e,n,n,s)];case 1:return(r=i.sent()).shape="circle",[2,r]}})})},n.prototype.linearPath=function(t,e){return r(this,void 0,Promise,function(){var r,n,s;return i(this,function(i){switch(i.label){case 0:return r=this._options(e),n=this._drawable,s=["linearPath"],[4,this.renderer.linearPath(t,!1,r)];case 1:return[2,n.apply(this,s.concat([[i.sent()],r]))]}})})},n.prototype.arc=function(t,e,n,s,a,o,h,c){return void 0===h&&(h=!1),r(this,void 0,Promise,function(){var r,l,u,p,f,d,y;return i(this,function(i){switch(i.label){case 0:return r=this._options(c),l=[],h&&r.fill?"solid"!==r.fillStyle?[3,2]:[4,this.renderer.arc(t,e,n,s,a,o,!0,!1,r)]:[3,4];case 1:return(u=i.sent()).type="fillPath",l.push(u),[3,4];case 2:return f=(p=l).push,[4,this.renderer.patternFillArc(t,e,n,s,a,o,r)];case 3:f.apply(p,[i.sent()]),i.label=4;case 4:return y=(d=l).push,[4,this.renderer.arc(t,e,n,s,a,o,h,!0,r)];case 5:return y.apply(d,[i.sent()]),[2,this._drawable("arc",l,r)]}})})},n.prototype.curve=function(t,e){return r(this,void 0,Promise,function(){var r,n,s;return i(this,function(i){switch(i.label){case 0:return r=this._options(e),n=this._drawable,s=["curve"],[4,this.renderer.curve(t,r)];case 1:return[2,n.apply(this,s.concat([[i.sent()],r]))]}})})},n.prototype.polygon=function(t,e){return r(this,void 0,Promise,function(){var r,n,s,a,o,h,c,l,u;return i(this,function(i){switch(i.label){case 0:return r=this._options(e),n=[],r.fill?"solid"!==r.fillStyle?[3,2]:(a=(s=n).push,[4,this.renderer.solidFillPolygon(t,r)]):[3,4];case 1:return a.apply(s,[i.sent()]),[3,4];case 2:return o=this.computePolygonSize(t),h=[[0,0],[o[0],0],[o[0],o[1]],[0,o[1]]],[4,this.renderer.patternFillPolygon(h,r)];case 3:(c=i.sent()).type="path2Dpattern",c.size=o,c.path=this.polygonPath(t),n.push(c),i.label=4;case 4:return u=(l=n).push,[4,this.renderer.linearPath(t,!0,r)];case 5:return u.apply(l,[i.sent()]),[2,this._drawable("polygon",n,r)]}})})},n.prototype.path=function(t,e){return r(this,void 0,Promise,function(){var r,n,s,a,o,h,c;return i(this,function(i){switch(i.label){case 0:return r=this._options(e),n=[],t?r.fill?"solid"!==r.fillStyle?[3,1]:(o={type:"path2Dfill",path:t,ops:[]},n.push(o),[3,3]):[3,3]:[2,this._drawable("path",n,r)];case 1:return s=this.computePathSize(t),a=[[0,0],[s[0],0],[s[0],s[1]],[0,s[1]]],[4,this.renderer.patternFillPolygon(a,r)];case 2:(o=i.sent()).type="path2Dpattern",o.size=s,o.path=t,n.push(o),i.label=3;case 3:return c=(h=n).push,[4,this.renderer.svgPath(t,r)];case 4:return c.apply(h,[i.sent()]),[2,this._drawable("path",n,r)]}})})},n}(s),K="undefined"!=typeof document,tt=function(t){function n(e,r){var i=t.call(this,e)||this;return i.gen=new J(r||null,i.canvas),i}return e(n,t),Object.defineProperty(n.prototype,"generator",{get:function(){return this.gen},enumerable:!0,configurable:!0}),n.prototype.getDefaultOptions=function(){return this.gen.defaultOptions},n.prototype.line=function(t,e,n,s,a){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.line(t,e,n,s,a)];case 1:return r=i.sent(),this.draw(r),[2,r]}})})},n.prototype.rectangle=function(t,e,n,s,a){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.rectangle(t,e,n,s,a)];case 1:return r=i.sent(),this.draw(r),[2,r]}})})},n.prototype.ellipse=function(t,e,n,s,a){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.ellipse(t,e,n,s,a)];case 1:return r=i.sent(),this.draw(r),[2,r]}})})},n.prototype.circle=function(t,e,n,s){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.circle(t,e,n,s)];case 1:return r=i.sent(),this.draw(r),[2,r]}})})},n.prototype.linearPath=function(t,e){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.linearPath(t,e)];case 1:return r=i.sent(),this.draw(r),[2,r]}})})},n.prototype.polygon=function(t,e){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.polygon(t,e)];case 1:return r=i.sent(),this.draw(r),[2,r]}})})},n.prototype.arc=function(t,e,n,s,a,o,h,c){return void 0===h&&(h=!1),r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.arc(t,e,n,s,a,o,h,c)];case 1:return r=i.sent(),this.draw(r),[2,r]}})})},n.prototype.curve=function(t,e){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.curve(t,e)];case 1:return r=i.sent(),this.draw(r),[2,r]}})})},n.prototype.path=function(t,e){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.path(t,e)];case 1:return r=i.sent(),this.draw(r),[2,r]}})})},n}(function(){function t(t){this.canvas=t,this.ctx=this.canvas.getContext("2d")}return t.prototype.draw=function(t){for(var e=t.sets||[],r=t.options||this.getDefaultOptions(),i=this.ctx,n=0,s=e;n<s.length;n++){var a=s[n];switch(a.type){case"path":i.save(),i.strokeStyle=r.stroke,i.lineWidth=r.strokeWidth,this._drawToContext(i,a),i.restore();break;case"fillPath":i.save(),i.fillStyle=r.fill||"",this._drawToContext(i,a),i.restore();break;case"fillSketch":this.fillSketch(i,a,r);break;case"path2Dfill":this.ctx.save(),this.ctx.fillStyle=r.fill||"";var o=new Path2D(a.path);this.ctx.fill(o),this.ctx.restore();break;case"path2Dpattern":var h=this.canvas.ownerDocument||K&&document;if(h){var c=a.size,l=h.createElement("canvas"),u=l.getContext("2d"),p=this.computeBBox(a.path);p&&(p.width||p.height)?(l.width=this.canvas.width,l.height=this.canvas.height,u.translate(p.x||0,p.y||0)):(l.width=c[0],l.height=c[1]),this.fillSketch(u,a,r),this.ctx.save(),this.ctx.fillStyle=this.ctx.createPattern(l,"repeat");o=new Path2D(a.path);this.ctx.fill(o),this.ctx.restore()}else console.error("Cannot render path2Dpattern. No defs/document defined.")}}},t.prototype.computeBBox=function(t){if(K)try{var e="http://www.w3.org/2000/svg",r=document.createElementNS(e,"svg");r.setAttribute("width","0"),r.setAttribute("height","0");var i=self.document.createElementNS(e,"path");i.setAttribute("d",t),r.appendChild(i),document.body.appendChild(r);var n=i.getBBox();return document.body.removeChild(r),n}catch(t){}return null},t.prototype.fillSketch=function(t,e,r){var i=r.fillWeight;i<0&&(i=r.strokeWidth/2),t.save(),t.strokeStyle=r.fill||"",t.lineWidth=i,this._drawToContext(t,e),t.restore()},t.prototype._drawToContext=function(t,e){t.beginPath();for(var r=0,i=e.ops;r<i.length;r++){var n=i[r],s=n.data;switch(n.op){case"move":t.moveTo(s[0],s[1]);break;case"bcurveTo":t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"qcurveTo":t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"lineTo":t.lineTo(s[0],s[1])}}"fillPath"===e.type?t.fill():t.stroke()},t}()),et="undefined"!=typeof document,rt=function(t){function n(e,r){var i=t.call(this,e)||this;return i.gen=new J(r||null,i.svg),i}return e(n,t),Object.defineProperty(n.prototype,"generator",{get:function(){return this.gen},enumerable:!0,configurable:!0}),n.prototype.getDefaultOptions=function(){return this.gen.defaultOptions},n.prototype.opsToPath=function(t){return this.gen.opsToPath(t)},n.prototype.line=function(t,e,n,s,a){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.line(t,e,n,s,a)];case 1:return r=i.sent(),[2,this.draw(r)]}})})},n.prototype.rectangle=function(t,e,n,s,a){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.rectangle(t,e,n,s,a)];case 1:return r=i.sent(),[2,this.draw(r)]}})})},n.prototype.ellipse=function(t,e,n,s,a){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.ellipse(t,e,n,s,a)];case 1:return r=i.sent(),[2,this.draw(r)]}})})},n.prototype.circle=function(t,e,n,s){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.circle(t,e,n,s)];case 1:return r=i.sent(),[2,this.draw(r)]}})})},n.prototype.linearPath=function(t,e){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.linearPath(t,e)];case 1:return r=i.sent(),[2,this.draw(r)]}})})},n.prototype.polygon=function(t,e){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.polygon(t,e)];case 1:return r=i.sent(),[2,this.draw(r)]}})})},n.prototype.arc=function(t,e,n,s,a,o,h,c){return void 0===h&&(h=!1),r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.arc(t,e,n,s,a,o,h,c)];case 1:return r=i.sent(),[2,this.draw(r)]}})})},n.prototype.curve=function(t,e){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.curve(t,e)];case 1:return r=i.sent(),[2,this.draw(r)]}})})},n.prototype.path=function(t,e){return r(this,void 0,Promise,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.gen.path(t,e)];case 1:return r=i.sent(),[2,this.draw(r)]}})})},n}(function(){function t(t){this.svg=t}return Object.defineProperty(t.prototype,"defs",{get:function(){var t=this.svg.ownerDocument||et&&document;if(t&&!this._defs){var e=t.createElementNS("http://www.w3.org/2000/svg","defs");this.svg.firstChild?this.svg.insertBefore(e,this.svg.firstChild):this.svg.appendChild(e),this._defs=e}return this._defs||null},enumerable:!0,configurable:!0}),t.prototype.draw=function(t){for(var e=t.sets||[],r=t.options||this.getDefaultOptions(),i=this.svg.ownerDocument||window.document,n=i.createElementNS("http://www.w3.org/2000/svg","g"),s=0,a=e;s<a.length;s++){var o=a[s],h=null;switch(o.type){case"path":(h=i.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",this.opsToPath(o)),h.style.stroke=r.stroke,h.style.strokeWidth=r.strokeWidth+"",h.style.fill="none";break;case"fillPath":(h=i.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",this.opsToPath(o)),h.style.stroke="none",h.style.strokeWidth="0",h.style.fill=r.fill||null;break;case"fillSketch":h=this.fillSketch(i,o,r);break;case"path2Dfill":(h=i.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",o.path||""),h.style.stroke="none",h.style.strokeWidth="0",h.style.fill=r.fill||null;break;case"path2Dpattern":if(this.defs){var c=o.size,l=i.createElementNS("http://www.w3.org/2000/svg","pattern"),u="rough-"+Math.floor(Math.random()*(Number.MAX_SAFE_INTEGER||999999));l.setAttribute("id",u),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("width","1"),l.setAttribute("height","1"),l.setAttribute("height","1"),l.setAttribute("viewBox","0 0 "+Math.round(c[0])+" "+Math.round(c[1])),l.setAttribute("patternUnits","objectBoundingBox");var p=this.fillSketch(i,o,r);l.appendChild(p),this.defs.appendChild(l),(h=i.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",o.path||""),h.style.stroke="none",h.style.strokeWidth="0",h.style.fill="url(#"+u+")"}else console.error("Cannot render path2Dpattern. No defs/document defined.")}h&&n.appendChild(h)}return n},t.prototype.fillSketch=function(t,e,r){var i=r.fillWeight;i<0&&(i=r.strokeWidth/2);var n=t.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",this.opsToPath(e)),n.style.stroke=r.fill||null,n.style.strokeWidth=i+"",n.style.fill="none",n},t}());return{canvas:function(t,e){return new tt(t,e)},svg:function(t,e){return new rt(t,e)},generator:function(t,e){return new J(t,e)}}}();
